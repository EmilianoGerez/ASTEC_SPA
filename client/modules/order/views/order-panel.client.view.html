<section ng-controller="OrderCtrl as vm" >
  <!-- Header -->
  <div class="row">
    <div class="col-xs-12">
      <div class="header">
        <h3 class="title"><i class="fa fa-plus"></i>Crear orden de A.T</h3>
      </div>
    </div>
  </div>
  <!-- Alert Error/Success -->
  <div class="row">
    <div class="col-xs-12">
      <div ng-show="vm.errorInfo.msg" class="alert alert-danger" role="alert">
        <p><strong>
          Error:
        </strong> {{vm.errorInfo.msg}}</p>
      </div>
      <div ng-show="vm.successInfo.msg" class="alert alert-success" role="alert">
        <p><strong>
          {{vm.successInfo.msg}}
        </strong></p>
        <p>Número: {{vm.successInfo.data.number}}</p>
      </div>
    </div>
  </div>
  <!-- Client Form -->
  <div class="row">
    <div class="col-xs-12">
      <div class="card">
        <div class="content">
          <div class="row">
            <!-- Search client -->
            <div ng-show="!vm.clientData">
              <div class="col-xs-12">
                <h4>Buscar cliente</h4>
                <hr>
              </div>
              <div class="col-xs-12 col-md-6">
                <label for="">Buscar por número</label>
                <div class="input-group">
                  <input type="number" class="form-control" placeholder="n° de cliente" ng-model="vm.clientSearch.number" ng-pattern="/^[0-9]/" step="1">
                  <span class="input-group-btn">
                    <button class="btn btn-primary btn-fill" type="button" ng-click="[vm.clientSearch.lastName = null, vm.searchClient()]">
                    <i class="fa fa-search"></i>
                    </button>
                  </span>
                </div>
              </div>
              <div class="col-xs-12 col-md-6">
                <label for="">Buscar por apellido</label>
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="apellido" ng-model="vm.clientSearch.lastName">
                  <span class="input-group-btn">
                    <button class="btn btn-primary btn-fill" type="button"
                    ng-click="[vm.clientSearch.number = null, vm.searchClient()]">
                    <i class="fa fa-search"></i>
                    </button>
                  </span>
                </div>
              </div>
              <div class="col-xs-12" ng-show="vm.clientList">
                <h4>Resultados</h4>
                <hr>
                <table class="table table-striped">
                  <thead>
                    <th>Número</th>
                    <th>Nombre</th>
                    <th>DNI</th>
                  </thead>
                  <tbody>
                    <tr ng-repeat="order in vm.clientList">
                      <td>{{order.number}}</td>
                      <td>{{order.firstName}} {{order.lastName}}</td>
                      <td>{{order.dni}}</td>
                      <td>
                        <button class="btn btn-fill btn-primary btn-xs"
                        ng-click="vm.clientData = order">
                        <i class="fa fa-chevron-right" aria-hidden="true"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <!-- Form wrapper -->
            <div ng-show="vm.clientData">
              <!-- Client Data -->
              <div class="col-xs-12">
                <h4>Datos del cliente</h4>
                <hr>
              </div>
              <div class="client-data">
                <div class="col-xs-12 col-md-6">
                  <div class="col-xs-12 col-sm-6">
                    <p><strong><i class="fa fa-user"></i>
                    {{vm.clientData.firstName}} {{vm.clientData.lastName}}</strong></p>
                    <p><strong><i class="fa fa-folder-open"></i>
                    Cliente</strong> {{vm.clientData.number}}</p>
                    <p><strong><i class="fa fa-book"></i>
                    DNI</strong> {{vm.clientData.dni}}</p>
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    <p><i class="fa fa-location-arrow"></i> {{vm.clientData.address}}</p>
                    <p><i class="fa fa-map-marker"></i> {{vm.clientData.city}} / {{vm.clientData.state}}</p>
                    <p><strong><i class="fa fa-phone"></i>
                    </strong> {{vm.clientData.phone}}</p>
                    <p><strong><i class="fa fa-mobile"></i>
                    </strong> {{vm.clientData.cellphone}}</p>
                  </div>
                  <div class="col-xs-12">
                    <button class="btn btn-xs btn-danger btn-fill pull-right"
                    ng-click="vm.clientData = null">
                    Eliminar
                    </button>
                  </div>
                </div>
              </div>
              <!-- Order Form -->
              <div class="col-xs-12">
                <h4>Datos de orden</h4>
                <hr>
              </div>
              <form name='createOrder' role='form' ng-submit="vm.create(createOrder)">
                <div class="col-xs-12 col-sm-6">
                  <div class="form-group">
                    <label for="tech">Técnico</label>
                    <select class="form-control" ng-model="vm.orderModel.tech">
                      <option>1</option>
                      <option>2</option>
                    </select>
                  </div>
                </div>
                <div class="col-xs-12">
                  <div class="form-group">
                    <label for="problem">Problema</label>
                    <textarea class="form-control" id="problem" placeholder="describir problema" rows="5" required="true" ng-model="vm.orderModel.problem">
                    </textarea>
                  </div>
                </div>
                <div class="col-xs-12">
                  <div class="form-group">
                    <button type="submit" class="btn btn-success btn-fill pull-right">Crear cliente</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Header -->
  <div class="row">
    <div class="col-xs-12">
      <div class="header">
        <h3 class="title"><i class="fa fa-search"></i>Buscar orden</h3>
      </div>
    </div>
  </div>
  <!-- Client Search -->
  <div class="row search-order">
    <div class="col-xs-12 col-md-6">
      <label for="">Buscar por número</label>
      <div class="input-group">
        <input type="number" class="form-control" placeholder="n° de cliente" ng-model="vm.orderSearch.number" ng-pattern="/^[0-9]/" step="1">
        <span class="input-group-btn">
          <button class="btn btn-primary btn-fill" type="button" ng-click="[vm.orderSearch.lastName = null, vm.searchOrder()]">
          <i class="fa fa-search"></i>
          </button>
        </span>
      </div>
    </div>
    <div class="col-xs-12 col-md-6">
      <label for="">Buscar por apellido</label>
      <div class="input-group">
        <input type="text" class="form-control" placeholder="apellido" ng-model="vm.orderSearch.lastName">
        <span class="input-group-btn">
          <button class="btn btn-primary btn-fill" type="button"
          ng-click="[vm.orderSearch.number = null, vm.searchOrder()]">
          <i class="fa fa-search"></i>
          </button>
        </span>
      </div>
    </div>
  </div>
  <!-- Orders Loop -->
  <div class="row">
    <div class="col-xs-12 col-lg-6" ng-repeat="order in vm.orderList">
      <div class="card">
        <div class="content">
          <div class="row">
            <div class="col-xs-12 col-lg-2">
              <p><span class="label label-warning">{{order.status}}</span></p>
            </div>
            <div class="col-xs-12 col-lg-8">
              <p>
                <strong><i class="fa fa-user"></i> {{order.client.firstName}} {{order.client.lastName}}</strong>
              </p>
              <p><i class="fa fa-calendar"></i> {{order.dateCreated}}</p>
              
              <p><strong>Problema:</strong>
                {{order.problem}}
              </p>
            </div>
            <div class="col-xs-12 col-lg-2">
              <button class="btn btn-default btn-simple dropdown-toggle pull-right" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              Acciones
              <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                <li><a href="/#/orders/{{order._id}}"><i class="fa fa-eye"></i> Ver detalle</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="/#/orders/{{order._id}}/edit"><i class="fa fa-edit"></i> Editar</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#" class="text-danger"><i class="fa fa-times"></i> Eliminar</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xs-12 text-center" ng-show="vm.orderList.length === 0">
      <h3><i class="fa fa-frown-o"></i>
      No se encontraron resultados para <strong>{{vm.searchWord}}</strong></h3>
    </div>
  </div>
  <!-- End order loop -->
</section>