function ClientCtrl(e,t,r,n){function a(t,r){e.search.query({id:null,number:t,lastName:r},function(e){o.clientList=e})}var i,o=this;o.clientModel={},o.clientSearch={},o.errorInfo={msg:null,data:null},o.successInfo={msg:null,data:null},o.create=function(t){var r=new e.api(o.clientModel);r.$save(function(e){angular.copy(i,o.clientModel),t.$setPristine(),t.$setUntouched(),o.errorInfo.msg=null,o.successInfo.msg="Cliente creado con exito",o.successInfo.data=e},function(e){o.successInfo.msg=null,o.errorInfo.msg=e.data})},o.search=function(){o.clientSearch.number?(o.searchWord=o.clientSearch.number,a(o.clientSearch.number,"null")):o.clientSearch.lastName&&(o.searchWord=o.clientSearch.lastName,a("null",o.clientSearch.lastName))},o.remove=function(e){var t=r.confirm("Quieres eliminar a "+e.firstName+" "+e.lastName+" ?");t&&e.$remove()},o.findOne=function(){e.api.get({id:n.id},function(e){o.clientModel=e})},o.update=function(e){o.clientModel.$update(function(t){e.$setPristine(),e.$setUntouched(),o.errorInfo.msg=null,o.successInfo.msg="Cliente editado con exito",o.successInfo.data=t},function(e){o.successInfo.msg=null,o.errorInfo.msg=e.data})}}function mainCtrl(e){var t=this,r=e.path();t.isHome="/"==r}function OrderCtrl(e,t,r,n,a){function i(e,r){t.search.query({id:null,number:e,lastName:r},function(e){l.clientList=e})}function o(t,r){e.search.query({id:null,number:t,lastName:r},function(e){l.orderList=e})}var l=this;l.orderModel={},l.orderSearch={},l.errorInfo={msg:null,data:null},l.successInfo={msg:null,data:null},l.solvedOpt=["No","Si"],l.orderStatus=["Cancelada","Asignada","Completada"],l.create=function(t){l.orderModel.client=l.clientData._id,l.orderModel.tech={id:"1",firstName:"Jesie",lastName:"Pinkman"};var r=new e.api(l.orderModel);r.$save(function(e){l.orderModel={},l.clientData=null,l.clientSearch={},l.clientList=null,t.$setPristine(),t.$setUntouched(),l.errorInfo.msg=null,l.successInfo.msg="Orden creada con exito",l.successInfo.data=e},function(e){l.successInfo.msg=null,l.errorInfo.msg=e.data})},l.searchClient=function(){l.clientSearch.number?(l.searchWord=l.clientSearch.number,i(l.clientSearch.number,"null")):l.clientSearch.lastName&&(l.searchWord=l.clientSearch.lastName,i("null",l.clientSearch.lastName))},l.searchOrder=function(){l.orderSearch.number?(l.searchWord=l.orderSearch.number,o(l.orderSearch.number,"null")):l.orderSearch.lastName&&(l.searchWord=l.orderSearch.lastName,o("null",l.orderSearch.lastName))},l.remove=function(e){var t=n.confirm("Quieres eliminar a "+e.firstName+" "+e.lastName+" ?");t&&e.$remove()},l.findOne=function(){e.api.get({id:a.id},function(e){l.orderModel=e})},l.update=function(e){l.orderModel.tech={id:"1",firstName:"Walter",lastName:"White"},l.orderModel.$update(function(t){e.$setPristine(),e.$setUntouched(),l.errorInfo.msg=null,l.successInfo.msg="Orden editada con Ã©xito",l.successInfo.data=t},function(e){l.successInfo.msg=null,l.errorInfo.msg=e.data})}}var appConfiguration=function(){var e="main",t=["ngResource","ui.router","angular-jwt","angular-storage","ngMessages"],r=function(t,r){angular.module(t,r||[]),angular.module(e).requires.push(t)};return{appName:e,appDependencies:t,registerModule:r}}();angular.module(appConfiguration.appName,appConfiguration.appDependencies),appConfiguration.registerModule("client"),appConfiguration.registerModule("order"),appConfiguration.registerModule("user"),angular.module("client").config(["$stateProvider",function(e){e.state("clientPanel",{url:"/clients",templateUrl:"modules/client/views/client-panel.client.view.html"}).state("editClient",{url:"/clients/:id/edit",templateUrl:"modules/client/views/edit-client.client.view.html"}).state("clientDetail",{url:"/clients/:id",templateUrl:"modules/client/views/client-detail.client.view.html",data:{requiresLogin:!0}})}]),angular.module("client").controller("ClientCtrl",["Clients","$http","$window","$stateParams",ClientCtrl]),angular.module("client").factory("Clients",["$resource",function(e){var t=e("api/clients/:id",{id:"@_id"},{update:{method:"PUT"}}),r=e("api/clients/:id/search/:number/:lastName",{id:"@_id",number:"number",lastName:"lastName"});return{api:t,search:r}}]),angular.module("main").config(["$stateProvider","$locationProvider","$urlRouterProvider","jwtInterceptorProvider","$httpProvider",function(e,t,r,n,a){r.otherwise("/"),n.tokenGetter=["jwtHelper","$http","store","$state","$rootScope",function(e,t,r,n,a){var i=r.get("jwt");try{return e.isTokenExpired(i)?t({url:"http://localhost:3000/api/users/refresh",skipAuthorization:!0,method:"POST",data:{token:i}}).then(function(e){var t=e.data.token;return r.set("jwt",t),t},function(e){return r.remove("jwt"),n.go("signin"),!1}):i}catch(o){return r.remove("jwt"),!1}}],a.interceptors.push("jwtInterceptor"),e.state("dashboard",{url:"/",templateUrl:"modules/main/views/dashboard.client.view.html"})}]),angular.module("main").controller("mainCtrl",["$location",mainCtrl]),angular.module("order").config(["$stateProvider",function(e){e.state("orderPanel",{url:"/orders",templateUrl:"modules/order/views/order-panel.client.view.html"}).state("editorder",{url:"/orders/:id/edit",templateUrl:"modules/order/views/edit-order.client.view.html"}).state("orderDetail",{url:"/orders/:id",templateUrl:"modules/order/views/order-detail.client.view.html"})}]),angular.module("order").controller("OrderCtrl",["Orders","Clients","$http","$window","$stateParams",OrderCtrl]),angular.module("order").factory("Orders",["$resource",function(e){var t=e("api/orders/:id",{id:"@_id"},{update:{method:"PUT"}}),r=e("api/orders/:id/search/:number/:lastName",{id:"@_id",number:"number",lastName:"lastName"});return{api:t,search:r}}]),angular.module("user").config(["$stateProvider",function(e){e.state("signup",{url:"/signup",templateUrl:"modules/user/views/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/user/views/signin.client.view.html"}).state("secureview",{url:"/secureview",templateUrl:"modules/user/views/secureview.client.view.html",data:{requiresLogin:!0}})}]).run(["$rootScope","$location","store","jwtHelper",function(e,t,r,n){e.$on("$stateChangeStart",function(e,n){return n.data&&n.data.requiresLogin&&!r.get("jwt")?t.path("signin"):void 0})}]),angular.module("user").controller("UserController",["$scope","$location","Users","$http","store","jwtHelper",function(e,t,r,n,a,i){e.user={name:"",password:"",confirmPassword:""},e.signup=function(){n({url:"http://localhost:3000/api/users/signup",method:"POST",data:e.user}).then(function(e){a.set("jwt",e.data.token),t.path("/")},function(t){e.errMessage=t.data.message})},e.signin=function(){n({url:"http://localhost:3000/api/users/signin",method:"POST",data:e.user}).then(function(e){var r=e.data.token;a.set("jwt",r),t.path("/")},function(t){e.errMessage=t.data.message})},e.isAuth=function(){var t=a.get("jwt");return t?(e.payload=i.decodeToken(t),!0):!1},e.logout=function(){var e=a.get("jwt"),t=i.decodeToken(e);r.logout.get({id:t._id},function(){a.remove("jwt")})}}]),angular.module("user").directive("compareTo",[function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,r,n){n.$validators.compareTo=function(t){return t==e.otherModelValue},e.$watch("otherModelValue",function(){n.$validate()})}}}]),angular.module("user").directive("recordAvailabilityValidator",["$http","Users",function(e,t){return{require:"ngModel",link:function(e,r,n,a){function i(e){a.$setValidity("recordLoading",!e)}function o(e){a.$setValidity("recordAvailable",e)}a.$parsers.push(function(e){if(e&&0!==e.length){i(!0),o(!1);var r=t.search.get({name:e},function(){null===r.data&&(i(!1),o(!0))});return e}})}}}]),angular.module("user").factory("Users",["$resource",function(e){var t=e("api/users/logout/:id",{id:"@_id"}),r=e("api/users/search/:name",{name:"@name"});return{logout:t,search:r}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9jb250cm9sbGVycy9jbGllbnQuY2xpZW50LmNvbnRyb2xsZXIuanMiLCJtYWluL2NvbnRyb2xsZXJzL21haW4uY2xpZW50LmNvbnRyb2xsZXIuanMiLCJvcmRlci9jb250cm9sbGVycy9vcmRlci5jbGllbnQuY29udHJvbGxlci5qcyIsImNvbmZpZy1hcHAuanMiLCJtYWluLWFwcC5qcyIsImNsaWVudC9jbGllbnQuY2xpZW50LnJlZ2lzdGVyLmpzIiwib3JkZXIvb3JkZXIuY2xpZW50LnJlZ2lzdGVyLmpzIiwidXNlci91c2VyLmNsaWVudC5yZWdpc3Rlci5qcyIsImNsaWVudC9jb25maWcvY2xpZW50LmNsaWVudC5yb3V0ZXMuanMiLCJjbGllbnQvc2VydmljZXMvY2xpZW50LmNsaWVudC5zZXJ2aWNlLmpzIiwibWFpbi9jb25maWcvbWFpbi5jbGllbnQucm91dGVzLmpzIiwib3JkZXIvY29uZmlnL29yZGVyLmNsaWVudC5yb3V0ZXMuanMiLCJvcmRlci9zZXJ2aWNlcy9vcmRlci5jbGllbnQuc2VydmljZS5qcyIsInVzZXIvY29uZmlnL3VzZXIuY2xpZW50LnJvdXRlcy5qcyIsInVzZXIvY29udHJvbGxlcnMvdXNlci5jbGllbnQuY29udHJvbGxlci5qcyIsInVzZXIvc2VydmljZXMvdXNlci5jbGllbnQuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJDbGllbnRDdHJsIiwiQ2xpZW50cyIsIiRodHRwIiwiJHdpbmRvdyIsIiRzdGF0ZVBhcmFtcyIsImdldENsaWVudCIsIm51bWJlciIsImxhc3ROYW1lIiwic2VhcmNoIiwicXVlcnkiLCJpZCIsInJlc3BvbnNlIiwidm0iLCJjbGllbnRMaXN0IiwibWFzdGVyTW9kZWwiLCJ0aGlzIiwiY2xpZW50TW9kZWwiLCJjbGllbnRTZWFyY2giLCJlcnJvckluZm8iLCJtc2ciLCJkYXRhIiwic3VjY2Vzc0luZm8iLCJjcmVhdGUiLCJmb3JtIiwibmV3Q2xpZW50IiwiYXBpIiwiJHNhdmUiLCJyZXMiLCJhbmd1bGFyIiwiY29weSIsIiRzZXRQcmlzdGluZSIsIiRzZXRVbnRvdWNoZWQiLCJlcnIiLCJzZWFyY2hXb3JkIiwicmVtb3ZlIiwiY2xpZW50IiwiY29uZmlybSIsImZpcnN0TmFtZSIsIiRyZW1vdmUiLCJmaW5kT25lIiwiZ2V0IiwidXBkYXRlIiwiJHVwZGF0ZSIsIm1haW5DdHJsIiwiJGxvY2F0aW9uIiwiY3VycmVudFBhdGgiLCJwYXRoIiwiaXNIb21lIiwiT3JkZXJDdHJsIiwiT3JkZXJzIiwiZ2V0Y2xpZW50IiwiZ2V0b3JkZXIiLCJvcmRlckxpc3QiLCJvcmRlck1vZGVsIiwib3JkZXJTZWFyY2giLCJzb2x2ZWRPcHQiLCJvcmRlclN0YXR1cyIsImNsaWVudERhdGEiLCJfaWQiLCJ0ZWNoIiwibmV3b3JkZXIiLCJzZWFyY2hDbGllbnQiLCJzZWFyY2hPcmRlciIsIm9yZGVyIiwiYXBwQ29uZmlndXJhdGlvbiIsImFwcE5hbWUiLCJhcHBEZXBlbmRlbmNpZXMiLCJyZWdpc3Rlck1vZHVsZSIsIm1vZHVsZU5hbWUiLCJtb2R1bGVEZXBlbmRlbmNpZXMiLCJtb2R1bGUiLCJyZXF1aXJlcyIsInB1c2giLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJyZXF1aXJlc0xvZ2luIiwiY29udHJvbGxlciIsImZhY3RvcnkiLCIkcmVzb3VyY2UiLCJtZXRob2QiLCIkbG9jYXRpb25Qcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsImp3dEludGVyY2VwdG9yUHJvdmlkZXIiLCIkaHR0cFByb3ZpZGVyIiwib3RoZXJ3aXNlIiwidG9rZW5HZXR0ZXIiLCJqd3RIZWxwZXIiLCJzdG9yZSIsIiRzdGF0ZSIsIiRyb290U2NvcGUiLCJpZFRva2VuIiwiaXNUb2tlbkV4cGlyZWQiLCJza2lwQXV0aG9yaXphdGlvbiIsInRva2VuIiwidGhlbiIsImlkX3Rva2VuIiwic2V0IiwiZ28iLCJpbnRlcmNlcHRvcnMiLCJydW4iLCIkb24iLCJlIiwidG8iLCIkc2NvcGUiLCJVc2VycyIsInVzZXIiLCJuYW1lIiwicGFzc3dvcmQiLCJjb25maXJtUGFzc3dvcmQiLCJzaWdudXAiLCJlcnJNZXNzYWdlIiwibWVzc2FnZSIsInNpZ25pbiIsImlzQXV0aCIsInBheWxvYWQiLCJkZWNvZGVUb2tlbiIsImxvZ291dCIsImRlY29kZWQiLCJkaXJlY3RpdmUiLCJyZXF1aXJlIiwic2NvcGUiLCJvdGhlck1vZGVsVmFsdWUiLCJsaW5rIiwiZWxlbWVudCIsImF0dHJpYnV0ZXMiLCJuZ01vZGVsIiwiJHZhbGlkYXRvcnMiLCJjb21wYXJlVG8iLCJtb2RlbFZhbHVlIiwiJHdhdGNoIiwiJHZhbGlkYXRlIiwiYXR0cnMiLCJzZXRBc0xvYWRpbmciLCJib29sIiwiJHNldFZhbGlkaXR5Iiwic2V0QXNBdmFpbGFibGUiLCIkcGFyc2VycyIsInZhbHVlIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiQUFBQSxRQUFBQSxZQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQWlGQSxRQUFBQyxHQUFBQyxFQUFBQyxHQUNBTixFQUFBTyxPQUFBQyxPQUNBQyxHQUFBLEtBQ0FKLE9BQUFBLEVBQ0FDLFNBQUFBLEdBQ0EsU0FBQUksR0FDQUMsRUFBQUMsV0FBQUYsSUF0RkEsR0FFQUcsR0FGQUYsRUFBQUcsSUFJQUgsR0FBQUksZUFDQUosRUFBQUssZ0JBQ0FMLEVBQUFNLFdBQ0FDLElBQUEsS0FDQUMsS0FBQSxNQUVBUixFQUFBUyxhQUNBRixJQUFBLEtBQ0FDLEtBQUEsTUFHQVIsRUFBQVUsT0FBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUEsR0FBQXZCLEdBQUF3QixJQUFBYixFQUFBSSxZQUVBUSxHQUFBRSxNQUFBLFNBQUFDLEdBRUFDLFFBQUFDLEtBQUFmLEVBQUFGLEVBQUFJLGFBQ0FPLEVBQUFPLGVBQ0FQLEVBQUFRLGdCQUVBbkIsRUFBQU0sVUFBQUMsSUFBQSxLQUNBUCxFQUFBUyxZQUFBRixJQUFBLDJCQUNBUCxFQUFBUyxZQUFBRCxLQUFBTyxHQUNBLFNBQUFLLEdBRUFwQixFQUFBUyxZQUFB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QUFTLE9BQUEsa0JBQUEsV0FDQUosRUFBQUssbUJBTUF6RyxRQUFBMEMsT0FBQSxRQUNBbUQsVUFBQSwrQkFBQSxRQUFBLFFBQUEsU0FBQXZILEVBQUF5RyxHQUVBLE9BQ0FlLFFBQUEsVUFDQUcsS0FBQSxTQUFBRixFQUFBRyxFQUFBUSxFQUFBTixHQUdBLFFBQUFPLEdBQUFDLEdBQ0FSLEVBQUFTLGFBQUEsaUJBQUFELEdBR0EsUUFBQUUsR0FBQUYsR0FDQVIsRUFBQVMsYUFBQSxrQkFBQUQsR0FHQVIsRUFBQVcsU0FBQW5FLEtBQUEsU0FBQW9FLEdBQ0EsR0FBQUEsR0FBQSxJQUFBQSxFQUFBQyxPQUFBLENBRUFOLEdBQUEsR0FDQUcsR0FBQSxFQUdBLElBQUF0SCxHQUFBdUYsRUFBQW5HLE9BQUFnQyxLQUNBcUUsS0FBQStCLEdBQ0EsV0FDQSxPQUFBeEgsRUFBQUEsT0FDQW1ILEdBQUEsR0FDQUcsR0FBQSxLQUdBLE9BQUFFLFdDMUdBaEgsUUFBQTBDLE9BQUEsUUFBQVUsUUFBQSxTQUFBLFlBQUEsU0FBQUMsR0FFQSxHQUFBc0MsR0FBQXRDLEVBQUEsd0JBQ0F2RSxHQUFBLFNBR0FGLEVBQUF5RSxFQUFBLDBCQUNBNEIsS0FBQSxTQUdBLFFBQ0FVLE9BQUFBLEVBQ0EvRyxPQUFBQSIsImZpbGUiOiJjb21wcmVzcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBDbGllbnRDdHJsKENsaWVudHMsICRodHRwLCAkd2luZG93LCAkc3RhdGVQYXJhbXMpIHtcclxuICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICB2YXIgbWFzdGVyTW9kZWw7XHJcblxyXG4gIHZtLmNsaWVudE1vZGVsID0ge307XHJcbiAgdm0uY2xpZW50U2VhcmNoID0ge307XHJcbiAgdm0uZXJyb3JJbmZvID0ge1xyXG4gICAgbXNnOiBudWxsLFxyXG4gICAgZGF0YTogbnVsbFxyXG4gIH07XHJcbiAgdm0uc3VjY2Vzc0luZm8gPSB7XHJcbiAgICBtc2c6IG51bGwsXHJcbiAgICBkYXRhOiBudWxsXHJcbiAgfTtcclxuXHJcbiAgdm0uY3JlYXRlID0gZnVuY3Rpb24oZm9ybSkge1xyXG4gICAgdmFyIG5ld0NsaWVudCA9IG5ldyBDbGllbnRzLmFwaSh2bS5jbGllbnRNb2RlbCk7XHJcblxyXG4gICAgbmV3Q2xpZW50LiRzYXZlKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAvL3Jlc2V0IGZvcm1cclxuICAgICAgYW5ndWxhci5jb3B5KG1hc3Rlck1vZGVsLCB2bS5jbGllbnRNb2RlbCk7XHJcbiAgICAgIGZvcm0uJHNldFByaXN0aW5lKCk7XHJcbiAgICAgIGZvcm0uJHNldFVudG91Y2hlZCgpO1xyXG4gICAgICAvL2FsZXJ0XHJcbiAgICAgIHZtLmVycm9ySW5mby5tc2cgPSBudWxsO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5tc2cgPSAnQ2xpZW50ZSBjcmVhZG8gY29uIGV4aXRvJztcclxuICAgICAgdm0uc3VjY2Vzc0luZm8uZGF0YSA9IHJlcztcclxuICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAvL2FsZXJ0XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLmVycm9ySW5mby5tc2cgPSBlcnIuZGF0YTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIHZtLnNlYXJjaCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHZtLmNsaWVudFNlYXJjaC5udW1iZXIpIHtcclxuICAgICAgdm0uc2VhcmNoV29yZCA9IHZtLmNsaWVudFNlYXJjaC5udW1iZXI7XHJcbiAgICAgIGdldENsaWVudCh2bS5jbGllbnRTZWFyY2gubnVtYmVyLCAnbnVsbCcpO1xyXG4gICAgfSBlbHNlIGlmICh2bS5jbGllbnRTZWFyY2gubGFzdE5hbWUpIHtcclxuICAgICAgdm0uc2VhcmNoV29yZCA9IHZtLmNsaWVudFNlYXJjaC5sYXN0TmFtZTtcclxuICAgICAgZ2V0Q2xpZW50KCdudWxsJywgdm0uY2xpZW50U2VhcmNoLmxhc3ROYW1lKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5yZW1vdmUgPSBmdW5jdGlvbihjbGllbnQpIHtcclxuICAgIHZhciBjb25maXJtID0gJHdpbmRvdy5jb25maXJtKCdRdWllcmVzIGVsaW1pbmFyIGEgJyArIGNsaWVudC5maXJzdE5hbWUgKyAnICcgKyBjbGllbnQubGFzdE5hbWUgKyAnID8nKTtcclxuXHJcbiAgICBpZiAoY29uZmlybSkge1xyXG4gICAgICBjbGllbnQuJHJlbW92ZSgpO1xyXG4gICAgICAgIC8vIHZtLmNsaWVudExpc3QgPSB2bS5jbGllbnRMaXN0LmZpbHRlcihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgLy8gICByZXR1cm4gZS5faWQgIT09IGNsaWVudC5faWQ7XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdm0uZmluZE9uZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgQ2xpZW50cy5hcGkuZ2V0KHtcclxuICAgICAgaWQ6ICRzdGF0ZVBhcmFtcy5pZFxyXG4gICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgdm0uY2xpZW50TW9kZWwgPSByZXNwb25zZTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIHZtLnVwZGF0ZSA9IGZ1bmN0aW9uKGZvcm0pe1xyXG4gICAgdm0uY2xpZW50TW9kZWwuJHVwZGF0ZShmdW5jdGlvbihyZXMpIHtcclxuICAgICAgLy9yZXNldCBmb3JtXHJcbiAgICAgIGZvcm0uJHNldFByaXN0aW5lKCk7XHJcbiAgICAgIGZvcm0uJHNldFVudG91Y2hlZCgpO1xyXG4gICAgICAvL2FsZXJ0XHJcbiAgICAgIHZtLmVycm9ySW5mby5tc2cgPSBudWxsO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5tc2cgPSAnQ2xpZW50ZSBlZGl0YWRvIGNvbiBleGl0byc7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLmRhdGEgPSByZXM7XHJcbiAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5zdWNjZXNzSW5mby5tc2cgPSBudWxsO1xyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gZXJyLmRhdGE7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAvLyBmdW5jdG9uIGhlbHBlcnMgKHByaXZhdGUpXHJcbiAgZnVuY3Rpb24gZ2V0Q2xpZW50KG51bWJlciwgbGFzdE5hbWUpIHtcclxuICAgIENsaWVudHMuc2VhcmNoLnF1ZXJ5KHtcclxuICAgICAgJ2lkJzogbnVsbCxcclxuICAgICAgJ251bWJlcic6IG51bWJlcixcclxuICAgICAgJ2xhc3ROYW1lJzogbGFzdE5hbWVcclxuICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgdm0uY2xpZW50TGlzdCA9IHJlc3BvbnNlO1xyXG4gICAgfSk7ICBcclxuICB9XHJcblxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgLm1vZHVsZSgnY2xpZW50JylcclxuICAuY29udHJvbGxlcignQ2xpZW50Q3RybCcsIFsnQ2xpZW50cycsICckaHR0cCcsICckd2luZG93JywgJyRzdGF0ZVBhcmFtcycsIENsaWVudEN0cmxdKTtcclxuLy8gYW5ndWxhci5tb2R1bGUoJ3VzZXInKVxyXG4vLyAgIC5kaXJlY3RpdmUoJ3JlY29yZEF2YWlsYWJpbGl0eVZhbGlkYXRvcicsIFsnJGh0dHAnLCAnVXNlcnMnLCBmdW5jdGlvbigkaHR0cCwgVXNlcnMpIHtcclxuXHJcbi8vICAgICByZXR1cm4ge1xyXG4vLyAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbi8vICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xyXG4vLyAgICAgICAgIC8vdmFyIGFwaVVybCA9IGF0dHJzLnJlY29yZEF2YWlsYWJpbGl0eVZhbGlkYXRvcjtcclxuXHJcbi8vICAgICAgICAgZnVuY3Rpb24gc2V0QXNMb2FkaW5nKGJvb2wpIHtcclxuLy8gICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRMb2FkaW5nJywgIWJvb2wpO1xyXG4vLyAgICAgICAgIH1cclxuXHJcbi8vICAgICAgICAgZnVuY3Rpb24gc2V0QXNBdmFpbGFibGUoYm9vbCkge1xyXG4vLyAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3JlY29yZEF2YWlsYWJsZScsIGJvb2wpO1xyXG4vLyAgICAgICAgIH1cclxuXHJcbi8vICAgICAgICAgbmdNb2RlbC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbi8vICAgICAgICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG5cclxuLy8gICAgICAgICAgIHNldEFzTG9hZGluZyh0cnVlKTtcclxuLy8gICAgICAgICAgIHNldEFzQXZhaWxhYmxlKGZhbHNlKTtcclxuXHJcbi8vICAgICAgICAgICAvLyB1c2luZyByZXNvdXJjZVxyXG4vLyAgICAgICAgICAgdmFyIGRhdGEgPSBVc2Vycy5zZWFyY2guZ2V0KHtcclxuLy8gICAgICAgICAgICAgbmFtZTogdmFsdWVcclxuLy8gICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4vLyAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhID09PSAnJykge1xyXG4vLyAgICAgICAgICAgICAgIHNldEFzTG9hZGluZyhmYWxzZSk7XHJcbi8vICAgICAgICAgICAgICAgc2V0QXNBdmFpbGFibGUodHJ1ZSk7XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgIH0pO1xyXG4vLyAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4vLyAgICAgICAgIH0pO1xyXG4vLyAgICAgICB9XHJcbi8vICAgICB9O1xyXG4vLyAgIH1dKTsiLCJmdW5jdGlvbiBtYWluQ3RybCgkbG9jYXRpb24pIHtcclxuXHR2YXIgdm0gPSB0aGlzO1xyXG5cclxuXHR2YXIgY3VycmVudFBhdGggPSAkbG9jYXRpb24ucGF0aCgpO1xyXG5cdHZtLmlzSG9tZSA9IChjdXJyZW50UGF0aCA9PSAnLycpID8gdHJ1ZSA6IGZhbHNlO1xyXG59XHJcblxyXG5hbmd1bGFyXHJcblx0Lm1vZHVsZSgnbWFpbicpXHJcblx0LmNvbnRyb2xsZXIoJ21haW5DdHJsJywgWyckbG9jYXRpb24nLCBtYWluQ3RybF0pOyIsImZ1bmN0aW9uIE9yZGVyQ3RybChPcmRlcnMsIENsaWVudHMsICRodHRwLCAkd2luZG93LCAkc3RhdGVQYXJhbXMpIHtcclxuICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICB2bS5vcmRlck1vZGVsID0ge307XHJcbiAgdm0ub3JkZXJTZWFyY2ggPSB7fTtcclxuICB2bS5lcnJvckluZm8gPSB7XHJcbiAgICBtc2c6IG51bGwsXHJcbiAgICBkYXRhOiBudWxsXHJcbiAgfTtcclxuICB2bS5zdWNjZXNzSW5mbyA9IHtcclxuICAgIG1zZzogbnVsbCxcclxuICAgIGRhdGE6IG51bGxcclxuICB9O1xyXG4gIHZtLnNvbHZlZE9wdCA9IFsnTm8nLCAnU2knXTtcclxuICB2bS5vcmRlclN0YXR1cyA9IFsnQ2FuY2VsYWRhJywgJ0FzaWduYWRhJywgJ0NvbXBsZXRhZGEnXTtcclxuXHJcbiAgdm0uY3JlYXRlID0gZnVuY3Rpb24oZm9ybSkge1xyXG4gICAgLy8gaGFyZGNvZGUgYXR0clxyXG4gICAgdm0ub3JkZXJNb2RlbC5jbGllbnQgPSB2bS5jbGllbnREYXRhLl9pZDtcclxuICAgIC8vIFRPRE9cclxuICAgIHZtLm9yZGVyTW9kZWwudGVjaCA9IHtcclxuICAgICAgaWQ6ICcxJyxcclxuICAgICAgZmlyc3ROYW1lOiAnSmVzaWUnLFxyXG4gICAgICBsYXN0TmFtZTogJ1BpbmttYW4nXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBuZXdvcmRlciA9IG5ldyBPcmRlcnMuYXBpKHZtLm9yZGVyTW9kZWwpO1xyXG5cclxuICAgIG5ld29yZGVyLiRzYXZlKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAvL3Jlc2V0IGZvcm1cclxuICAgICAgdm0ub3JkZXJNb2RlbCA9IHt9O1xyXG4gICAgICB2bS5jbGllbnREYXRhID0gbnVsbDtcclxuICAgICAgdm0uY2xpZW50U2VhcmNoID0ge307XHJcbiAgICAgIHZtLmNsaWVudExpc3QgPSBudWxsO1xyXG4gICAgICBmb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICBmb3JtLiRzZXRVbnRvdWNoZWQoKTtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gJ09yZGVuIGNyZWFkYSBjb24gZXhpdG8nO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5kYXRhID0gcmVzO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IGVyci5kYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgdm0uc2VhcmNoQ2xpZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodm0uY2xpZW50U2VhcmNoLm51bWJlcikge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0uY2xpZW50U2VhcmNoLm51bWJlcjtcclxuICAgICAgZ2V0Y2xpZW50KHZtLmNsaWVudFNlYXJjaC5udW1iZXIsICdudWxsJyk7XHJcbiAgICB9IGVsc2UgaWYgKHZtLmNsaWVudFNlYXJjaC5sYXN0TmFtZSkge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0uY2xpZW50U2VhcmNoLmxhc3ROYW1lO1xyXG4gICAgICBnZXRjbGllbnQoJ251bGwnLCB2bS5jbGllbnRTZWFyY2gubGFzdE5hbWUpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHZtLnNlYXJjaE9yZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodm0ub3JkZXJTZWFyY2gubnVtYmVyKSB7XHJcbiAgICAgIHZtLnNlYXJjaFdvcmQgPSB2bS5vcmRlclNlYXJjaC5udW1iZXI7XHJcbiAgICAgIGdldG9yZGVyKHZtLm9yZGVyU2VhcmNoLm51bWJlciwgJ251bGwnKTtcclxuICAgIH0gZWxzZSBpZiAodm0ub3JkZXJTZWFyY2gubGFzdE5hbWUpIHtcclxuICAgICAgdm0uc2VhcmNoV29yZCA9IHZtLm9yZGVyU2VhcmNoLmxhc3ROYW1lO1xyXG4gICAgICBnZXRvcmRlcignbnVsbCcsIHZtLm9yZGVyU2VhcmNoLmxhc3ROYW1lKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5yZW1vdmUgPSBmdW5jdGlvbihvcmRlcikge1xyXG4gICAgdmFyIGNvbmZpcm0gPSAkd2luZG93LmNvbmZpcm0oJ1F1aWVyZXMgZWxpbWluYXIgYSAnICsgb3JkZXIuZmlyc3ROYW1lICsgJyAnICsgb3JkZXIubGFzdE5hbWUgKyAnID8nKTtcclxuXHJcbiAgICBpZiAoY29uZmlybSkge1xyXG4gICAgICBvcmRlci4kcmVtb3ZlKCk7XHJcbiAgICAgIC8vIHZtLm9yZGVyTGlzdCA9IHZtLm9yZGVyTGlzdC5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAvLyAgIHJldHVybiBlLl9pZCAhPT0gb3JkZXIuX2lkO1xyXG4gICAgICAvLyB9KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5maW5kT25lID0gZnVuY3Rpb24oKSB7XHJcbiAgICBPcmRlcnMuYXBpLmdldCh7XHJcbiAgICAgIGlkOiAkc3RhdGVQYXJhbXMuaWRcclxuICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHZtLm9yZGVyTW9kZWwgPSByZXNwb25zZTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIHZtLnVwZGF0ZSA9IGZ1bmN0aW9uKGZvcm0pIHtcclxuICAgIC8vIFRPRE9cclxuICAgIHZtLm9yZGVyTW9kZWwudGVjaCA9IHtcclxuICAgICAgaWQ6ICcxJyxcclxuICAgICAgZmlyc3ROYW1lOiAnV2FsdGVyJyxcclxuICAgICAgbGFzdE5hbWU6ICdXaGl0ZSdcclxuICAgIH07XHJcblxyXG4gICAgdm0ub3JkZXJNb2RlbC4kdXBkYXRlKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAvL3Jlc2V0IGZvcm1cclxuICAgICAgZm9ybS4kc2V0UHJpc3RpbmUoKTtcclxuICAgICAgZm9ybS4kc2V0VW50b3VjaGVkKCk7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9ICdPcmRlbiBlZGl0YWRhIGNvbiDDqXhpdG8nO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5kYXRhID0gcmVzO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IGVyci5kYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gZnVuY3RvbiBoZWxwZXJzIChwcml2YXRlKVxyXG4gIGZ1bmN0aW9uIGdldGNsaWVudChudW1iZXIsIGxhc3ROYW1lKSB7XHJcbiAgICBDbGllbnRzLnNlYXJjaC5xdWVyeSh7XHJcbiAgICAgICdpZCc6IG51bGwsXHJcbiAgICAgICdudW1iZXInOiBudW1iZXIsXHJcbiAgICAgICdsYXN0TmFtZSc6IGxhc3ROYW1lXHJcbiAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB2bS5jbGllbnRMaXN0ID0gcmVzcG9uc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldG9yZGVyKG51bWJlciwgbGFzdE5hbWUpIHtcclxuICAgIE9yZGVycy5zZWFyY2gucXVlcnkoe1xyXG4gICAgICAnaWQnOiBudWxsLFxyXG4gICAgICAnbnVtYmVyJzogbnVtYmVyLFxyXG4gICAgICAnbGFzdE5hbWUnOiBsYXN0TmFtZVxyXG4gICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgdm0ub3JkZXJMaXN0ID0gcmVzcG9uc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgLm1vZHVsZSgnb3JkZXInKVxyXG4gIC5jb250cm9sbGVyKCdPcmRlckN0cmwnLCBbJ09yZGVycycsICdDbGllbnRzJywgJyRodHRwJywgJyR3aW5kb3cnLCAnJHN0YXRlUGFyYW1zJywgT3JkZXJDdHJsXSk7XHJcbi8vIGFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuLy8gICAuZGlyZWN0aXZlKCdyZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3InLCBbJyRodHRwJywgJ1VzZXJzJywgZnVuY3Rpb24oJGh0dHAsIFVzZXJzKSB7XHJcblxyXG4vLyAgICAgcmV0dXJuIHtcclxuLy8gICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4vLyAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcclxuLy8gICAgICAgICAvL3ZhciBhcGlVcmwgPSBhdHRycy5yZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3I7XHJcblxyXG4vLyAgICAgICAgIGZ1bmN0aW9uIHNldEFzTG9hZGluZyhib29sKSB7XHJcbi8vICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgncmVjb3JkTG9hZGluZycsICFib29sKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIGZ1bmN0aW9uIHNldEFzQXZhaWxhYmxlKGJvb2wpIHtcclxuLy8gICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRBdmFpbGFibGUnLCBib29sKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIG5nTW9kZWwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xyXG4vLyAgICAgICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHJcbi8vICAgICAgICAgICBzZXRBc0xvYWRpbmcodHJ1ZSk7XHJcbi8vICAgICAgICAgICBzZXRBc0F2YWlsYWJsZShmYWxzZSk7XHJcblxyXG4vLyAgICAgICAgICAgLy8gdXNpbmcgcmVzb3VyY2VcclxuLy8gICAgICAgICAgIHZhciBkYXRhID0gVXNlcnMuc2VhcmNoLmdldCh7XHJcbi8vICAgICAgICAgICAgIG5hbWU6IHZhbHVlXHJcbi8vICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuLy8gICAgICAgICAgICAgaWYgKGRhdGEuZGF0YSA9PT0gJycpIHtcclxuLy8gICAgICAgICAgICAgICBzZXRBc0xvYWRpbmcoZmFsc2UpO1xyXG4vLyAgICAgICAgICAgICAgIHNldEFzQXZhaWxhYmxlKHRydWUpO1xyXG4vLyAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuLy8gICAgICAgICB9KTtcclxuLy8gICAgICAgfVxyXG4vLyAgICAgfTtcclxuLy8gICB9XSk7IiwidmFyIGFwcENvbmZpZ3VyYXRpb24gPSAoZnVuY3Rpb24oKSB7XHJcblx0dmFyIGFwcE5hbWUgPSAnbWFpbic7XHJcblx0dmFyIGFwcERlcGVuZGVuY2llcyA9IFsnbmdSZXNvdXJjZScsICd1aS5yb3V0ZXInLCAnYW5ndWxhci1qd3QnLCAnYW5ndWxhci1zdG9yYWdlJywgJ25nTWVzc2FnZXMnXTtcclxuXHJcblx0Ly9NZXRob2QgZm9yIGFkZCBuZXcgbW9kdWxlc1xyXG5cdHZhciByZWdpc3Rlck1vZHVsZSA9IGZ1bmN0aW9uKG1vZHVsZU5hbWUsIG1vZHVsZURlcGVuZGVuY2llcykge1xyXG5cdFx0Ly8gQ3JlYXRlIG1vZHVsZVxyXG5cdFx0YW5ndWxhci5tb2R1bGUobW9kdWxlTmFtZSwgbW9kdWxlRGVwZW5kZW5jaWVzIHx8IFtdKTtcclxuXHJcblx0XHQvLyBBZGQgdGhlIG5ldyBtb2R1bGUgdG8gdGhlIGFuZ3VsYXIgY29uZmlnIGZpbGVcclxuXHRcdGFuZ3VsYXIubW9kdWxlKGFwcE5hbWUpLnJlcXVpcmVzLnB1c2gobW9kdWxlTmFtZSk7XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGFwcE5hbWU6IGFwcE5hbWUsXHJcblx0XHRhcHBEZXBlbmRlbmNpZXM6IGFwcERlcGVuZGVuY2llcyxcclxuXHRcdHJlZ2lzdGVyTW9kdWxlOiByZWdpc3Rlck1vZHVsZVxyXG5cdH1cclxufSkgKCk7IiwiLy9EZWZpbmUgbWFpbiBtb2R1bGVcclxuYW5ndWxhci5tb2R1bGUoYXBwQ29uZmlndXJhdGlvbi5hcHBOYW1lLCBhcHBDb25maWd1cmF0aW9uLmFwcERlcGVuZGVuY2llcyk7IiwiYXBwQ29uZmlndXJhdGlvbi5yZWdpc3Rlck1vZHVsZSgnY2xpZW50Jyk7IiwiYXBwQ29uZmlndXJhdGlvbi5yZWdpc3Rlck1vZHVsZSgnb3JkZXInKTsiLCJhcHBDb25maWd1cmF0aW9uLnJlZ2lzdGVyTW9kdWxlKCd1c2VyJyk7IiwiYW5ndWxhci5tb2R1bGUoJ2NsaWVudCcpXHJcbiAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpIHtcclxuXHJcbiAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAuc3RhdGUoJ2NsaWVudFBhbmVsJywge1xyXG4gICAgICAgIHVybDogJy9jbGllbnRzJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvY2xpZW50L3ZpZXdzL2NsaWVudC1wYW5lbC5jbGllbnQudmlldy5odG1sJ1xyXG4gICAgICB9KS5zdGF0ZSgnZWRpdENsaWVudCcsIHtcclxuICAgICAgICB1cmw6ICcvY2xpZW50cy86aWQvZWRpdCcsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2NsaWVudC92aWV3cy9lZGl0LWNsaWVudC5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgfSkuc3RhdGUoJ2NsaWVudERldGFpbCcsIHtcclxuICAgICAgICB1cmw6ICcvY2xpZW50cy86aWQnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9jbGllbnQvdmlld3MvY2xpZW50LWRldGFpbC5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICByZXF1aXJlc0xvZ2luOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XSk7IiwiLy9BcnRpY2xlcyBzZXJ2aWNlIHVzZWQgZm9yIGNvbW11bmljYXRpbmcgd2l0aCB0aGUgYXJ0aWNsZXMgUkVTVCBlbmRwb2ludHNcclxuYW5ndWxhci5tb2R1bGUoJ2NsaWVudCcpLmZhY3RvcnkoJ0NsaWVudHMnLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uKCRyZXNvdXJjZSkge1xyXG5cclxuXHR2YXIgYXBpID0gJHJlc291cmNlKCdhcGkvY2xpZW50cy86aWQnLCB7XHJcblx0XHRpZDogJ0BfaWQnXHJcblx0fSwge1xyXG5cdFx0dXBkYXRlOiB7XHJcblx0XHRcdG1ldGhvZDogJ1BVVCdcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dmFyIHNlYXJjaCA9ICRyZXNvdXJjZSgnYXBpL2NsaWVudHMvOmlkL3NlYXJjaC86bnVtYmVyLzpsYXN0TmFtZScsIHtcclxuXHRcdGlkOiAnQF9pZCcsXHJcblx0XHRudW1iZXI6ICdudW1iZXInLFxyXG5cdFx0bGFzdE5hbWU6ICdsYXN0TmFtZSdcclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGFwaTogYXBpLFxyXG5cdFx0c2VhcmNoOiBzZWFyY2hcclxuXHR9O1xyXG59XSk7IiwiYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFpbicpXHJcbiAgICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgJ2p3dEludGVyY2VwdG9yUHJvdmlkZXInLCAnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCBqd3RJbnRlcmNlcHRvclByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKSB7XHJcbiAgICAgICAgLy8gUmVkaXJlY3QgdG8gaG9tZSB2aWV3IHdoZW4gcm91dGUgbm90IGZvdW5kXHJcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG5cclxuICAgICAgICAvLyB1c2UgdGhlIEhUTUw1IEhpc3RvcnkgQVBJXHJcbiAgICAgICAgLy8kbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIC8vIGdldCB0b2tlbiB0byBsb2NhbCBzdG9yYWdlIGFuZCBzZXQgb24gdGhlIGhlYWRlcnNcclxuICAgICAgICBqd3RJbnRlcmNlcHRvclByb3ZpZGVyLnRva2VuR2V0dGVyID0gWydqd3RIZWxwZXInLCAnJGh0dHAnLCAnc3RvcmUnLCAnJHN0YXRlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbihqd3RIZWxwZXIsICRodHRwLCBzdG9yZSwgJHN0YXRlLCAkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIHZhciBpZFRva2VuID0gc3RvcmUuZ2V0KCdqd3QnKTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGlmIChqd3RIZWxwZXIuaXNUb2tlbkV4cGlyZWQoaWRUb2tlbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgcHJvbWlzZSBvZiBhIEpXVCBpZF90b2tlblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXNlcnMvcmVmcmVzaCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgbWFrZXMgaXQgc28gdGhhdCB0aGlzIHJlcXVlc3QgZG9lc24ndCBzZW5kIHRoZSBKV1RcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2tpcEF1dGhvcml6YXRpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogaWRUb2tlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRfdG9rZW4gPSByZXNwb25zZS5kYXRhLnRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yZS5zZXQoJ2p3dCcsIGlkX3Rva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkX3Rva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yZS5yZW1vdmUoJ2p3dCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3NpZ25pbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpZFRva2VuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHN0b3JlLnJlbW92ZSgnand0Jyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XTtcclxuICAgICAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdqd3RJbnRlcmNlcHRvcicpO1xyXG5cclxuICAgICAgICAvLyBIb21lIHN0YXRlIHJvdXRpbmdcclxuICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgICAuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL21haW4vdmlld3MvZGFzaGJvYXJkLmNsaWVudC52aWV3Lmh0bWwnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdvcmRlcicpXHJcbiAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpIHtcclxuXHJcbiAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAuc3RhdGUoJ29yZGVyUGFuZWwnLCB7XHJcbiAgICAgICAgdXJsOiAnL29yZGVycycsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL29yZGVyL3ZpZXdzL29yZGVyLXBhbmVsLmNsaWVudC52aWV3Lmh0bWwnXHJcbiAgICAgIH0pLnN0YXRlKCdlZGl0b3JkZXInLCB7XHJcbiAgICAgICAgdXJsOiAnL29yZGVycy86aWQvZWRpdCcsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL29yZGVyL3ZpZXdzL2VkaXQtb3JkZXIuY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgIH0pLnN0YXRlKCdvcmRlckRldGFpbCcsIHtcclxuICAgICAgICB1cmw6ICcvb3JkZXJzLzppZCcsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL29yZGVyL3ZpZXdzL29yZGVyLWRldGFpbC5jbGllbnQudmlldy5odG1sJ1xyXG4gICAgICB9KTtcclxuICB9XSk7IiwiLy9BcnRpY2xlcyBzZXJ2aWNlIHVzZWQgZm9yIGNvbW11bmljYXRpbmcgd2l0aCB0aGUgYXJ0aWNsZXMgUkVTVCBlbmRwb2ludHNcclxuYW5ndWxhci5tb2R1bGUoJ29yZGVyJykuZmFjdG9yeSgnT3JkZXJzJywgWyckcmVzb3VyY2UnLCBmdW5jdGlvbigkcmVzb3VyY2UpIHtcclxuXHJcblx0dmFyIGFwaSA9ICRyZXNvdXJjZSgnYXBpL29yZGVycy86aWQnLCB7XHJcblx0XHRpZDogJ0BfaWQnXHJcblx0fSwge1xyXG5cdFx0dXBkYXRlOiB7XHJcblx0XHRcdG1ldGhvZDogJ1BVVCdcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dmFyIHNlYXJjaCA9ICRyZXNvdXJjZSgnYXBpL29yZGVycy86aWQvc2VhcmNoLzpudW1iZXIvOmxhc3ROYW1lJywge1xyXG5cdFx0aWQ6ICdAX2lkJyxcclxuXHRcdG51bWJlcjogJ251bWJlcicsXHJcblx0XHRsYXN0TmFtZTogJ2xhc3ROYW1lJ1xyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0YXBpOiBhcGksXHJcblx0XHRzZWFyY2g6IHNlYXJjaFxyXG5cdH07XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgndXNlcicpXHJcbiAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpIHtcclxuXHJcbiAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAuc3RhdGUoJ3NpZ251cCcsIHtcclxuICAgICAgICB1cmw6ICcvc2lnbnVwJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvdXNlci92aWV3cy9zaWdudXAuY2xpZW50LnZpZXcuaHRtbCdcclxuICAgICAgfSkuc3RhdGUoJ3NpZ25pbicsIHtcclxuICAgICAgICB1cmw6ICcvc2lnbmluJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvdXNlci92aWV3cy9zaWduaW4uY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgIH0pLnN0YXRlKCdzZWN1cmV2aWV3Jywge1xyXG4gICAgICAgIHVybDogJy9zZWN1cmV2aWV3JyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvdXNlci92aWV3cy9zZWN1cmV2aWV3LmNsaWVudC52aWV3Lmh0bWwnLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHJlcXVpcmVzTG9naW46IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gIH1dKVxyXG4gIC5ydW4oWyckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICdzdG9yZScsICdqd3RIZWxwZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkbG9jYXRpb24sIHN0b3JlLCBqd3RIZWxwZXIpIHtcclxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKGUsIHRvKSB7XHJcbiAgICAgIGlmICh0by5kYXRhICYmIHRvLmRhdGEucmVxdWlyZXNMb2dpbikge1xyXG4gICAgICAgIGlmICghc3RvcmUuZ2V0KCdqd3QnKSkge1xyXG4gICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5wYXRoKCdzaWduaW4nKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgndXNlcicpXHJcbiAgLmNvbnRyb2xsZXIoJ1VzZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ1VzZXJzJywgJyRodHRwJywgJ3N0b3JlJywgJ2p3dEhlbHBlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBVc2VycywgJGh0dHAsIHN0b3JlLCBqd3RIZWxwZXIpIHtcclxuICAgICRzY29wZS51c2VyID0ge1xyXG4gICAgICBuYW1lOiBcIlwiLFxyXG4gICAgICBwYXNzd29yZDogXCJcIixcclxuICAgICAgY29uZmlybVBhc3N3b3JkOiBcIlwiXHJcbiAgICB9O1xyXG4gICAgJHNjb3BlLnNpZ251cCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAkaHR0cCh7XHJcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2Vycy9zaWdudXAnLFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGRhdGE6ICRzY29wZS51c2VyXHJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBzdG9yZS5zZXQoJ2p3dCcsIHJlc3BvbnNlLmRhdGEudG9rZW4pO1xyXG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICRzY29wZS5lcnJNZXNzYWdlID0gZXJyLmRhdGEubWVzc2FnZTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zaWduaW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgJGh0dHAoe1xyXG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdXNlcnMvc2lnbmluJyxcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBkYXRhOiAkc2NvcGUudXNlclxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVzcG9uc2UuZGF0YS50b2tlbjtcclxuICAgICAgICBzdG9yZS5zZXQoJ2p3dCcsIHRva2VuKTtcclxuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAkc2NvcGUuZXJyTWVzc2FnZSA9IGVyci5kYXRhLm1lc3NhZ2U7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuaXNBdXRoID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB0b2tlbiA9IHN0b3JlLmdldCgnand0Jyk7XHJcbiAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICRzY29wZS5wYXlsb2FkID0gand0SGVscGVyLmRlY29kZVRva2VuKHRva2VuKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgdG9rZW4gPSBzdG9yZS5nZXQoJ2p3dCcpO1xyXG4gICAgICB2YXIgZGVjb2RlZCA9IGp3dEhlbHBlci5kZWNvZGVUb2tlbih0b2tlbik7XHJcbiAgICAgIFVzZXJzLmxvZ291dC5nZXQoe1xyXG4gICAgICAgIGlkOiBkZWNvZGVkLl9pZFxyXG4gICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICBzdG9yZS5yZW1vdmUoJ2p3dCcpO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfV0pO1xyXG5cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuICAuZGlyZWN0aXZlKFwiY29tcGFyZVRvXCIsIFtmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcXVpcmU6IFwibmdNb2RlbFwiLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIG90aGVyTW9kZWxWYWx1ZTogXCI9Y29tcGFyZVRvXCJcclxuICAgICAgfSxcclxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMsIG5nTW9kZWwpIHtcclxuXHJcbiAgICAgICAgbmdNb2RlbC4kdmFsaWRhdG9ycy5jb21wYXJlVG8gPSBmdW5jdGlvbihtb2RlbFZhbHVlKSB7XHJcbiAgICAgICAgICByZXR1cm4gbW9kZWxWYWx1ZSA9PSBzY29wZS5vdGhlck1vZGVsVmFsdWU7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgc2NvcGUuJHdhdGNoKFwib3RoZXJNb2RlbFZhbHVlXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgbmdNb2RlbC4kdmFsaWRhdGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XSk7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgndXNlcicpXHJcbiAgLmRpcmVjdGl2ZSgncmVjb3JkQXZhaWxhYmlsaXR5VmFsaWRhdG9yJywgWyckaHR0cCcsICdVc2VycycsIGZ1bmN0aW9uKCRodHRwLCBVc2Vycykge1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XHJcbiAgICAgICAgLy92YXIgYXBpVXJsID0gYXR0cnMucmVjb3JkQXZhaWxhYmlsaXR5VmFsaWRhdG9yO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRBc0xvYWRpbmcoYm9vbCkge1xyXG4gICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3JlY29yZExvYWRpbmcnLCAhYm9vbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRBc0F2YWlsYWJsZShib29sKSB7XHJcbiAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgncmVjb3JkQXZhaWxhYmxlJywgYm9vbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBuZ01vZGVsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgIGlmICghdmFsdWUgfHwgdmFsdWUubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgc2V0QXNMb2FkaW5nKHRydWUpO1xyXG4gICAgICAgICAgc2V0QXNBdmFpbGFibGUoZmFsc2UpO1xyXG5cclxuICAgICAgICAgIC8vIHVzaW5nIHJlc291cmNlXHJcbiAgICAgICAgICB2YXIgZGF0YSA9IFVzZXJzLnNlYXJjaC5nZXQoe1xyXG4gICAgICAgICAgICBuYW1lOiB2YWx1ZVxyXG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmRhdGEgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICBzZXRBc0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgICAgIHNldEFzQXZhaWxhYmxlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XSk7IiwiLy9BcnRpY2xlcyBzZXJ2aWNlIHVzZWQgZm9yIGNvbW11bmljYXRpbmcgd2l0aCB0aGUgYXJ0aWNsZXMgUkVTVCBlbmRwb2ludHNcclxuYW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdVc2VycycsIFsnJHJlc291cmNlJywgZnVuY3Rpb24oJHJlc291cmNlKSB7XHJcblxyXG4gICAgdmFyIGxvZ291dCA9ICRyZXNvdXJjZSgnYXBpL3VzZXJzL2xvZ291dC86aWQnLCB7XHJcbiAgICAgICAgaWQ6ICdAX2lkJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHNlYXJjaCA9ICRyZXNvdXJjZSgnYXBpL3VzZXJzL3NlYXJjaC86bmFtZScsIHtcclxuICAgICAgICBuYW1lOiAnQG5hbWUnXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGxvZ291dDogbG9nb3V0LFxyXG4gICAgICAgIHNlYXJjaDogc2VhcmNoXHJcbiAgICB9O1xyXG59XHJcbl0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
