function ClientCtrl(e,r,t,n){function i(r,t){e.search.query({id:null,number:r,lastName:t},function(e){a.clientList=e})}var o,a=this;a.clientModel={},a.clientSearch={},a.errorInfo={msg:null,data:null},a.successInfo={msg:null,data:null},a.create=function(r){var t=new e.api(a.clientModel);t.$save(function(e){angular.copy(o,a.clientModel),r.$setPristine(),r.$setUntouched(),a.errorInfo.msg=null,a.successInfo.msg="Cliente creado con exito",a.successInfo.data=e},function(e){a.successInfo.msg=null,a.errorInfo.msg=e.data})},a.search=function(){a.clientSearch.number?(a.searchWord=a.clientSearch.number,i(a.clientSearch.number,"null")):a.clientSearch.lastName&&(a.searchWord=a.clientSearch.lastName,i("null",a.clientSearch.lastName))},a.remove=function(e){var r=t.confirm("Quieres eliminar a "+e.firstName+" "+e.lastName+" ?");r&&(e.$remove(),a.clientList=a.clientList.filter(function(r){return r._id!==e._id}))},a.findOne=function(){e.api.get({id:n.id},function(e){a.clientModel=e})},a.update=function(e){a.clientModel.$update(function(r){e.$setPristine(),e.$setUntouched(),a.errorInfo.msg=null,a.successInfo.msg="Cliente editado con exito",a.successInfo.data=r},function(e){a.successInfo.msg=null,a.errorInfo.msg=e.data})}}function mainCtrl(e,r){var t=this;t.getCurrentUser=function(){t.currentUserData=e.getCurrentUserData()}(),t.logout=function(){t.currentUserData={},e.logout()},t.getOrders=function(){var e=t.currentUserData;t.isAdmin="Admin"==e.role,t.isAdmin?r.api.query(function(e){t.orders=e}):r.api.query(function(r){t.orders=r.filter(function(r){return r.tech.id==e._id})})}}function OrderCtrl(e,r,t,n,i,o){function a(e,t){r.search.query({id:null,number:e,lastName:t},function(e){u.clientList=e})}function s(r,t){e.search.query({id:null,number:r,lastName:t},function(e){u.orderList=e})}var u=this;u.orderModel={},u.orderSearch={},u.errorInfo={msg:null,data:null},u.successInfo={msg:null,data:null},u.solvedOpt=["No","Si"],u.orderStatus=["Cancelada","Asignada","Completada"],u.selectedTech="",u.create=function(r){u.orderModel.client=u.clientData._id,u.orderModel.tech={id:u.selectedTech._id,firstName:u.selectedTech.firstName,lastName:u.selectedTech.lastName};var t=new e.api(u.orderModel);t.$save(function(e){u.orderModel={},u.clientData=null,u.clientSearch={},u.clientList=null,r.$setPristine(),r.$setUntouched(),u.errorInfo.msg=null,u.successInfo.msg="Orden creada con exito",u.successInfo.data=e},function(e){u.successInfo.msg=null,u.errorInfo.msg=e.data})},u.searchClient=function(){u.clientSearch.number?(u.searchWord=u.clientSearch.number,a(u.clientSearch.number,"null")):u.clientSearch.lastName&&(u.searchWord=u.clientSearch.lastName,a("null",u.clientSearch.lastName))},u.searchOrder=function(){u.orderSearch.number?(u.searchWord=u.orderSearch.number,s(u.orderSearch.number,"null")):u.orderSearch.lastName&&(u.searchWord=u.orderSearch.lastName,s("null",u.orderSearch.lastName))},u.remove=function(e){var r=i.confirm("Quieres eliminar la orden N° #"+e.number+" ?");r&&(e.$remove(),u.orderList=u.orderList.filter(function(r){return r._id!==e._id}))},u.findOne=function(r){e.api.get({id:o.id},function(e){u.orderModel=e,r&&(u.selectedTech=u.users.filter(function(e){return e._id===u.orderModel.tech.id}),u.selectedTech=u.selectedTech[0])})},u.update=function(e){u.orderModel.tech={id:u.selectedTech._id,firstName:u.selectedTech.firstName,lastName:u.selectedTech.lastName},u.orderModel.$update(function(r){e.$setPristine(),e.$setUntouched(),u.errorInfo.msg=null,u.successInfo.msg="Orden editada con éxito",u.successInfo.data=r},function(e){u.successInfo.msg=null,u.errorInfo.msg=e.data})},u.getAllUsers=function(){t.api.query(function(e){u.users=e.filter(function(e){return"Tech"===e.role})})}}function dlKeyCode(){return{restrict:"A",link:function(e,r,t){r.bind("keypress",function(r){var n=r.which||r.keyCode;n==t.code&&e.$apply(function(){e.$eval(t.dlKeyCode,{$event:r})})})}}}function UserServ(e,r,t,n){this.getCurrentUserData=function(){var t=e.get("jwt");if(t){var n=r.decodeToken(t);return n}return!1},this.logout=function(){var r=this.getCurrentUserData();n.logout.get({id:r._id},function(){e.remove("jwt"),t.location.href="/"})}}var appConfiguration=function(){var e="main",r=["ngResource","ui.router","angular-jwt","angular-storage","ngMessages"],t=function(r,t){angular.module(r,t||[]),angular.module(e).requires.push(r)};return{appName:e,appDependencies:r,registerModule:t}}();angular.module(appConfiguration.appName,appConfiguration.appDependencies),appConfiguration.registerModule("client"),appConfiguration.registerModule("order"),appConfiguration.registerModule("user"),angular.module("client").config(["$stateProvider",function(e){e.state("clientPanel",{url:"/clients",templateUrl:"modules/client/views/client-panel.client.view.html",data:{requiresLogin:!0}}).state("editClient",{url:"/clients/:id/edit",templateUrl:"modules/client/views/edit-client.client.view.html",data:{requiresLogin:!0}})}]),angular.module("client").controller("ClientCtrl",["Clients","$http","$window","$stateParams",ClientCtrl]),angular.module("client").factory("Clients",["$resource",function(e){var r=e("api/clients/:id",{id:"@_id"},{update:{method:"PUT"}}),t=e("api/clients/:id/search/:number/:lastName",{id:"@_id",number:"number",lastName:"lastName"});return{api:r,search:t}}]),angular.module("main").config(["$stateProvider","$locationProvider","$urlRouterProvider",function(e,r,t){t.otherwise("/"),e.state("dashboard",{url:"/",templateUrl:"modules/main/views/dashboard.client.view.html",data:{requiresLogin:!0}})}]),angular.module("main").controller("mainCtrl",["UserServ","Orders",mainCtrl]),angular.module("main").directive("ngEnter",function(){return function(e,r,t){r.bind("keydown keypress",function(r){13===r.which&&(e.$apply(function(){e.$eval(t.ngEnter,{event:r})}),r.preventDefault())})}}),angular.module("order").config(["$stateProvider",function(e){e.state("orderPanel",{url:"/orders",templateUrl:"modules/order/views/order-panel.client.view.html",data:{requiresLogin:!0}}).state("editorder",{url:"/orders/:id/edit",templateUrl:"modules/order/views/edit-order.client.view.html",data:{requiresLogin:!0}}).state("orderDetail",{url:"/orders/:id",templateUrl:"modules/order/views/order-detail.client.view.html",data:{requiresLogin:!0}})}]),angular.module("order").controller("OrderCtrl",["Orders","Clients","Users","$http","$window","$stateParams",OrderCtrl]),angular.module("order").directive("dlKeyCode",dlKeyCode),angular.module("order").factory("Orders",["$resource",function(e){var r=e("api/orders/:id",{id:"@_id"},{update:{method:"PUT"}}),t=e("api/orders/:id/search/:number/:lastName",{id:"@_id",number:"number",lastName:"lastName"});return{api:r,search:t}}]),angular.module("user").config(["$stateProvider","jwtInterceptorProvider","$httpProvider",function(e,r,t){e.state("signin",{url:"/signin",templateUrl:"modules/user/views/signin.client.view.html",data:{requiresLogin:!1}}).state("userList",{url:"/users",templateUrl:"modules/user/views/user-list.client.view.html",data:{requiresLogin:!0}}).state("editUser",{url:"/users/:id/edit",templateUrl:"modules/user/views/user-edit.client.view.html",data:{requiresLogin:!0}}),r.tokenGetter=["jwtHelper","$http","store","$state",function(e,r,t,n){var i=t.get("jwt");try{return e.isTokenExpired(i)?r({url:"http://localhost:7000/api/users/refresh",skipAuthorization:!0,method:"POST",data:{token:i}}).then(function(e){var r=e.data.token;return t.set("jwt",r),console.log("RefresToke: "+r),r},function(e){return console.log(e),t.remove("jwt"),n.go("signin"),!1}):i}catch(o){return t.remove("jwt"),!1}}],t.interceptors.push("jwtInterceptor")}]).run(["$rootScope","$window","store",function(e,r,t){e.$on("$stateChangeStart",function(e,n){n.data&&n.data.requiresLogin&&(t.get("jwt")||(r.location.href="/signin#/signin"))})}]),angular.module("user").controller("UserController",["$window","Users","UserServ","$http","store","jwtHelper","$stateParams","$state",function(e,r,t,n,i,o,a,s){var u=this;u.user={},u.errorInfo={},u.publicSignup=function(){var t=new r.api(u.user);t.$save(function(r){i.set("jwt",r.token),e.location.href="/panel"},function(e){u.errorInfo=e.data})},u.signup=function(){u.user.role=u.user.role?"Admin":"Tech";var e=new r.api(u.user);e.$save(function(e){u.users.push(u.user),u.user={}},function(e){u.errorInfo=e.data})},u.signin=function(){var t=new r.signin(u.user);t.$save(function(r){i.set("jwt",r.token),e.location.href="/panel#/"},function(e){u.errorInfo=e.data})},u.getAll=function(){r.api.query(function(e){u.users=e.filter(function(e){return e._id!==u.currentUser._id})})},u.getOne=function(){r.api.get({id:a.id},function(e){u.user=e})},u.getCurrentUser=function(){u.currentUser=t.getCurrentUserData()},u.update=function(){u.user.$update(function(e){s.go("userList")},function(e){u.errorInfo=e.data})},u.remove=function(r){var t=e.confirm("Quieres eliminar el usuario "+r.firstName+" "+r.lastName+" ?");t&&(r.$remove(),u.users=u.users.filter(function(e){return e._id!==r._id}))}}]),angular.module("user").directive("compareTo",[function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,r,t,n){n.$validators.compareTo=function(r){return r==e.otherModelValue},e.$watch("otherModelValue",function(){n.$validate()})}}}]),angular.module("user").directive("recordAvailabilityValidator",["$http","Users",function(e,r){return{require:"ngModel",link:function(e,t,n,i){function o(e){i.$setValidity("recordLoading",!e)}function a(e){i.$setValidity("recordAvailable",e)}i.$parsers.push(function(e){if(e&&0!==e.length){o(!0),a(!1);var t=r.search.get({email:e},function(){null===t.data&&(o(!1),a(!0))});return e}})}}}]),angular.module("user").service("UserServ",["store","jwtHelper","$window","Users",UserServ]),angular.module("user").factory("Users",["$resource",function(e){var r=e("api/users/:id",{id:"@_id"},{update:{method:"PUT"}}),t=e("api/users/signin"),n=e("api/users/logout/:id",{id:"@_id"}),i=e("api/users/search/:email",{email:"@email"});return{api:r,signin:t,logout:n,search:i}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9jb250cm9sbGVycy9jbGllbnQuY2xpZW50LmNvbnRyb2xsZXIuanMiLCJtYWluL2NvbnRyb2xsZXJzL21haW4uY2xpZW50LmNvbnRyb2xsZXIuanMiLCJvcmRlci9jb250cm9sbGVycy9vcmRlci5jbGllbnQuY29udHJvbGxlci5qcyIsIm9yZGVyL2RpcmVjdGl2ZXMvb3JkZXIuZGlyZWN0aXZlcy5qcyIsInVzZXIvc2VydmljZXMvdXNlci1zZXJ2LmNsaWVudC5zZXJ2aWNlLmpzIiwiY29uZmlnLWFwcC5qcyIsIm1haW4tYXBwLmpzIiwiY2xpZW50L2NsaWVudC5jbGllbnQucmVnaXN0ZXIuanMiLCJvcmRlci9vcmRlci5jbGllbnQucmVnaXN0ZXIuanMiLCJ1c2VyL3VzZXIuY2xpZW50LnJlZ2lzdGVyLmpzIiwiY2xpZW50L2NvbmZpZy9jbGllbnQuY2xpZW50LnJvdXRlcy5qcyIsImNsaWVudC9zZXJ2aWNlcy9jbGllbnQuY2xpZW50LnNlcnZpY2UuanMiLCJtYWluL2NvbmZpZy9tYWluLmNsaWVudC5yb3V0ZXMuanMiLCJtYWluL2RpcmVjdGl2ZXMvbmdFbnRlci5kaXJlY3RpdmUuanMiLCJvcmRlci9jb25maWcvb3JkZXIuY2xpZW50LnJvdXRlcy5qcyIsIm9yZGVyL3NlcnZpY2VzL29yZGVyLmNsaWVudC5zZXJ2aWNlLmpzIiwidXNlci9jb25maWcvdXNlci5jbGllbnQucm91dGVzLmpzIiwidXNlci9jb250cm9sbGVycy91c2VyLmNsaWVudC5jb250cm9sbGVyLmpzIiwidXNlci9zZXJ2aWNlcy91c2VyLmNsaWVudC5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIkNsaWVudEN0cmwiLCJDbGllbnRzIiwiJGh0dHAiLCIkd2luZG93IiwiJHN0YXRlUGFyYW1zIiwiZ2V0Q2xpZW50IiwibnVtYmVyIiwibGFzdE5hbWUiLCJzZWFyY2giLCJxdWVyeSIsImlkIiwicmVzcG9uc2UiLCJ2bSIsImNsaWVudExpc3QiLCJtYXN0ZXJNb2RlbCIsInRoaXMiLCJjbGllbnRNb2RlbCIsImNsaWVudFNlYXJjaCIsImVycm9ySW5mbyIsIm1zZyIsImRhdGEiLCJzdWNjZXNzSW5mbyIsImNyZWF0ZSIsImZvcm0iLCJuZXdDbGllbnQiLCJhcGkiLCIkc2F2ZSIsInJlcyIsImFuZ3VsYXIiLCJjb3B5IiwiJHNldFByaXN0aW5lIiwiJHNldFVudG91Y2hlZCIsImVyciIsInNlYXJjaFdvcmQiLCJyZW1vdmUiLCJjbGllbnQiLCJjb25maXJtIiwiZmlyc3ROYW1lIiwiJHJlbW92ZSIsImZpbHRlciIsImUiLCJfaWQiLCJmaW5kT25lIiwiZ2V0IiwidXBkYXRlIiwiJHVwZGF0ZSIsIm1haW5DdHJsIiwiVXNlclNlcnYiLCJPcmRlcnMiLCJnZXRDdXJyZW50VXNlciIsImN1cnJlbnRVc2VyRGF0YSIsImdldEN1cnJlbnRVc2VyRGF0YSIsImxvZ291dCIsImdldE9yZGVycyIsInVzZXIiLCJpc0FkbWluIiwicm9sZSIsIm9yZGVycyIsInRlY2giLCJPcmRlckN0cmwiLCJVc2VycyIsImdldGNsaWVudCIsImdldG9yZGVyIiwib3JkZXJMaXN0Iiwib3JkZXJNb2RlbCIsIm9yZGVyU2VhcmNoIiwic29sdmVkT3B0Iiwib3JkZXJTdGF0dXMiLCJzZWxlY3RlZFRlY2giLCJjbGllbnREYXRhIiwibmV3b3JkZXIiLCJzZWFyY2hDbGllbnQiLCJzZWFyY2hPcmRlciIsIm9yZGVyIiwiZWRpdCIsInVzZXJzIiwiZ2V0QWxsVXNlcnMiLCJkbEtleUNvZGUiLCJyZXN0cmljdCIsImxpbmsiLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsImJpbmQiLCJldmVudCIsImtleUNvZGUiLCJ3aGljaCIsImNvZGUiLCIkYXBwbHkiLCIkZXZhbCIsIiRldmVudCIsInN0b3JlIiwiand0SGVscGVyIiwidG9rZW4iLCJwYXlsb2FkIiwiZGVjb2RlVG9rZW4iLCJkZWNvZGVkIiwibG9jYXRpb24iLCJocmVmIiwiYXBwQ29uZmlndXJhdGlvbiIsImFwcE5hbWUiLCJhcHBEZXBlbmRlbmNpZXMiLCJyZWdpc3Rlck1vZHVsZSIsIm1vZHVsZU5hbWUiLCJtb2R1bGVEZXBlbmRlbmNpZXMiLCJtb2R1bGUiLCJyZXF1aXJlcyIsInB1c2giLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJyZXF1aXJlc0xvZ2luIiwiY29udHJvbGxlciIsImZhY3RvcnkiLCIkcmVzb3VyY2UiLCJtZXRob2QiLCIkbG9jYXRpb25Qcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIm90aGVyd2lzZSIsImRpcmVjdGl2ZSIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwibmdFbnRlciIsInByZXZlbnREZWZhdWx0Iiwiand0SW50ZXJjZXB0b3JQcm92aWRlciIsIiRodHRwUHJvdmlkZXIiLCJ0b2tlbkdldHRlciIsIiRzdGF0ZSIsImlkVG9rZW4iLCJpc1Rva2VuRXhwaXJlZCIsInNraXBBdXRob3JpemF0aW9uIiwidGhlbiIsImlkX3Rva2VuIiwic2V0IiwiY29uc29sZSIsImxvZyIsImdvIiwiaW50ZXJjZXB0b3JzIiwicnVuIiwiJHJvb3RTY29wZSIsIiRvbiIsInRvIiwicHVibGljU2lnbnVwIiwibmV3VXNlciIsInNpZ251cCIsInNpZ25pbiIsImdldEFsbCIsImN1cnJlbnRVc2VyIiwiZ2V0T25lIiwicmVxdWlyZSIsIm90aGVyTW9kZWxWYWx1ZSIsImF0dHJpYnV0ZXMiLCJuZ01vZGVsIiwiJHZhbGlkYXRvcnMiLCJjb21wYXJlVG8iLCJtb2RlbFZhbHVlIiwiJHdhdGNoIiwiJHZhbGlkYXRlIiwic2V0QXNMb2FkaW5nIiwiYm9vbCIsIiRzZXRWYWxpZGl0eSIsInNldEFzQXZhaWxhYmxlIiwiJHBhcnNlcnMiLCJ2YWx1ZSIsImxlbmd0aCIsImVtYWlsIiwic2VydmljZSJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsWUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FpRkEsUUFBQUMsR0FBQUMsRUFBQUMsR0FDQU4sRUFBQU8sT0FBQUMsT0FDQUMsR0FB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R0FFQSxPQUNBNEYsUUFBQSxVQUNBekUsS0FBQSxTQUFBMkMsRUFBQUMsRUFBQUMsRUFBQStCLEdBR0EsUUFBQU0sR0FBQUMsR0FDQVAsRUFBQVEsYUFBQSxpQkFBQUQsR0FHQSxRQUFBRSxHQUFBRixHQUNBUCxFQUFBUSxhQUFBLGtCQUFBRCxHQUdBUCxFQUFBVSxTQUFBMUQsS0FBQSxTQUFBMkQsR0FDQSxHQUFBQSxHQUFBLElBQUFBLEVBQUFDLE9BQUEsQ0FFQU4sR0FBQSxHQUNBRyxHQUFBLEVBR0EsSUFBQWhKLEdBQUF3QyxFQUFBcEQsT0FBQW1DLEtBQ0E2SCxNQUFBRixHQUNBLFdBQ0EsT0FBQWxKLEVBQUFBLE9BQ0E2SSxHQUFBLEdBQ0FHLEdBQUEsS0FHQSxPQUFBRSxXYmxIQTFJLFFBQ0E2RSxPQUFBLFFBQ0FnRSxRQUFBLFlBQUEsUUFBQSxZQUFBLFVBQUEsUUFBQTFILFdjeEJBbkIsUUFBQTZFLE9BQUEsUUFBQVUsUUFBQSxTQUFBLFlBQUEsU0FBQUMsR0FFQSxHQUFBM0YsR0FBQTJGLEVBQUEsaUJBQ0ExRyxHQUFBLFNBRUFrQyxRQUNBeUUsT0FBQSxTQUlBK0IsRUFBQWhDLEVBQUEsb0JBRUFoRSxFQUFBZ0UsRUFBQSx3QkFDQTFHLEdBQUEsU0FHQUYsRUFBQTRHLEVBQUEsMkJBQ0FvRCxNQUFBLFVBR0EsUUFDQS9JLElBQUFBLEVBQ0EySCxPQUFBQSxFQUNBaEcsT0FBQUEsRUFDQTVDLE9BQUFBIiwiZmlsZSI6ImNvbXByZXNzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIENsaWVudEN0cmwoQ2xpZW50cywgJGh0dHAsICR3aW5kb3csICRzdGF0ZVBhcmFtcykge1xyXG4gIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gIHZhciBtYXN0ZXJNb2RlbDtcclxuXHJcbiAgdm0uY2xpZW50TW9kZWwgPSB7fTtcclxuICB2bS5jbGllbnRTZWFyY2ggPSB7fTtcclxuICB2bS5lcnJvckluZm8gPSB7XHJcbiAgICBtc2c6IG51bGwsXHJcbiAgICBkYXRhOiBudWxsXHJcbiAgfTtcclxuICB2bS5zdWNjZXNzSW5mbyA9IHtcclxuICAgIG1zZzogbnVsbCxcclxuICAgIGRhdGE6IG51bGxcclxuICB9O1xyXG5cclxuICB2bS5jcmVhdGUgPSBmdW5jdGlvbihmb3JtKSB7XHJcbiAgICB2YXIgbmV3Q2xpZW50ID0gbmV3IENsaWVudHMuYXBpKHZtLmNsaWVudE1vZGVsKTtcclxuXHJcbiAgICBuZXdDbGllbnQuJHNhdmUoZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgIC8vcmVzZXQgZm9ybVxyXG4gICAgICBhbmd1bGFyLmNvcHkobWFzdGVyTW9kZWwsIHZtLmNsaWVudE1vZGVsKTtcclxuICAgICAgZm9ybS4kc2V0UHJpc3RpbmUoKTtcclxuICAgICAgZm9ybS4kc2V0VW50b3VjaGVkKCk7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9ICdDbGllbnRlIGNyZWFkbyBjb24gZXhpdG8nO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5kYXRhID0gcmVzO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IGVyci5kYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgdm0uc2VhcmNoID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodm0uY2xpZW50U2VhcmNoLm51bWJlcikge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0uY2xpZW50U2VhcmNoLm51bWJlcjtcclxuICAgICAgZ2V0Q2xpZW50KHZtLmNsaWVudFNlYXJjaC5udW1iZXIsICdudWxsJyk7XHJcbiAgICB9IGVsc2UgaWYgKHZtLmNsaWVudFNlYXJjaC5sYXN0TmFtZSkge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0uY2xpZW50U2VhcmNoLmxhc3ROYW1lO1xyXG4gICAgICBnZXRDbGllbnQoJ251bGwnLCB2bS5jbGllbnRTZWFyY2gubGFzdE5hbWUpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHZtLnJlbW92ZSA9IGZ1bmN0aW9uKGNsaWVudCkge1xyXG4gICAgdmFyIGNvbmZpcm0gPSAkd2luZG93LmNvbmZpcm0oJ1F1aWVyZXMgZWxpbWluYXIgYSAnICsgY2xpZW50LmZpcnN0TmFtZSArICcgJyArIGNsaWVudC5sYXN0TmFtZSArICcgPycpO1xyXG5cclxuICAgIGlmIChjb25maXJtKSB7XHJcbiAgICAgIGNsaWVudC4kcmVtb3ZlKCk7XHJcbiAgICAgIHZtLmNsaWVudExpc3QgPSB2bS5jbGllbnRMaXN0LmZpbHRlcihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgcmV0dXJuIGUuX2lkICE9PSBjbGllbnQuX2lkO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5maW5kT25lID0gZnVuY3Rpb24oKSB7XHJcbiAgICBDbGllbnRzLmFwaS5nZXQoe1xyXG4gICAgICBpZDogJHN0YXRlUGFyYW1zLmlkXHJcbiAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB2bS5jbGllbnRNb2RlbCA9IHJlc3BvbnNlO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgdm0udXBkYXRlID0gZnVuY3Rpb24oZm9ybSl7XHJcbiAgICB2bS5jbGllbnRNb2RlbC4kdXBkYXRlKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAvL3Jlc2V0IGZvcm1cclxuICAgICAgZm9ybS4kc2V0UHJpc3RpbmUoKTtcclxuICAgICAgZm9ybS4kc2V0VW50b3VjaGVkKCk7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9ICdDbGllbnRlIGVkaXRhZG8gY29uIGV4aXRvJztcclxuICAgICAgdm0uc3VjY2Vzc0luZm8uZGF0YSA9IHJlcztcclxuICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAvL2FsZXJ0XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLmVycm9ySW5mby5tc2cgPSBlcnIuZGF0YTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIC8vIGZ1bmN0b24gaGVscGVycyAocHJpdmF0ZSlcclxuICBmdW5jdGlvbiBnZXRDbGllbnQobnVtYmVyLCBsYXN0TmFtZSkge1xyXG4gICAgQ2xpZW50cy5zZWFyY2gucXVlcnkoe1xyXG4gICAgICAnaWQnOiBudWxsLFxyXG4gICAgICAnbnVtYmVyJzogbnVtYmVyLFxyXG4gICAgICAnbGFzdE5hbWUnOiBsYXN0TmFtZVxyXG4gICAgfSwgZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICB2bS5jbGllbnRMaXN0ID0gcmVzcG9uc2U7XHJcbiAgICB9KTsgIFxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmFuZ3VsYXJcclxuICAubW9kdWxlKCdjbGllbnQnKVxyXG4gIC5jb250cm9sbGVyKCdDbGllbnRDdHJsJywgWydDbGllbnRzJywgJyRodHRwJywgJyR3aW5kb3cnLCAnJHN0YXRlUGFyYW1zJywgQ2xpZW50Q3RybF0pO1xyXG4vLyBhbmd1bGFyLm1vZHVsZSgndXNlcicpXHJcbi8vICAgLmRpcmVjdGl2ZSgncmVjb3JkQXZhaWxhYmlsaXR5VmFsaWRhdG9yJywgWyckaHR0cCcsICdVc2VycycsIGZ1bmN0aW9uKCRodHRwLCBVc2Vycykge1xyXG5cclxuLy8gICAgIHJldHVybiB7XHJcbi8vICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuLy8gICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XHJcbi8vICAgICAgICAgLy92YXIgYXBpVXJsID0gYXR0cnMucmVjb3JkQXZhaWxhYmlsaXR5VmFsaWRhdG9yO1xyXG5cclxuLy8gICAgICAgICBmdW5jdGlvbiBzZXRBc0xvYWRpbmcoYm9vbCkge1xyXG4vLyAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3JlY29yZExvYWRpbmcnLCAhYm9vbCk7XHJcbi8vICAgICAgICAgfVxyXG5cclxuLy8gICAgICAgICBmdW5jdGlvbiBzZXRBc0F2YWlsYWJsZShib29sKSB7XHJcbi8vICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgncmVjb3JkQXZhaWxhYmxlJywgYm9vbCk7XHJcbi8vICAgICAgICAgfVxyXG5cclxuLy8gICAgICAgICBuZ01vZGVsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcclxuLy8gICAgICAgICAgIGlmICghdmFsdWUgfHwgdmFsdWUubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4vLyAgICAgICAgICAgc2V0QXNMb2FkaW5nKHRydWUpO1xyXG4vLyAgICAgICAgICAgc2V0QXNBdmFpbGFibGUoZmFsc2UpO1xyXG5cclxuLy8gICAgICAgICAgIC8vIHVzaW5nIHJlc291cmNlXHJcbi8vICAgICAgICAgICB2YXIgZGF0YSA9IFVzZXJzLnNlYXJjaC5nZXQoe1xyXG4vLyAgICAgICAgICAgICBuYW1lOiB2YWx1ZVxyXG4vLyAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbi8vICAgICAgICAgICAgIGlmIChkYXRhLmRhdGEgPT09ICcnKSB7XHJcbi8vICAgICAgICAgICAgICAgc2V0QXNMb2FkaW5nKGZhbHNlKTtcclxuLy8gICAgICAgICAgICAgICBzZXRBc0F2YWlsYWJsZSh0cnVlKTtcclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgfSk7XHJcbi8vICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbi8vICAgICAgICAgfSk7XHJcbi8vICAgICAgIH1cclxuLy8gICAgIH07XHJcbi8vICAgfV0pOyIsImZ1bmN0aW9uIG1haW5DdHJsKFVzZXJTZXJ2LCBPcmRlcnMpIHtcclxuXHR2YXIgdm0gPSB0aGlzO1xyXG5cclxuXHJcblx0dm0uZ2V0Q3VycmVudFVzZXIgPSAoZnVuY3Rpb24oKSB7XHJcblx0XHR2bS5jdXJyZW50VXNlckRhdGEgPSBVc2VyU2Vydi5nZXRDdXJyZW50VXNlckRhdGEoKTtcclxuXHR9KSgpO1xyXG5cdFxyXG5cdHZtLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dm0uY3VycmVudFVzZXJEYXRhID0ge307XHJcblx0XHRVc2VyU2Vydi5sb2dvdXQoKTtcclxuXHR9O1xyXG5cclxuXHR2bS5nZXRPcmRlcnMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB1c2VyID0gdm0uY3VycmVudFVzZXJEYXRhO1xyXG5cdFx0dm0uaXNBZG1pbiA9ICh1c2VyLnJvbGUgPT0gJ0FkbWluJykgPyB0cnVlIDogZmFsc2U7XHJcblxyXG5cdFx0aWYgKHZtLmlzQWRtaW4pIHtcclxuXHRcdFx0T3JkZXJzLmFwaS5xdWVyeShmdW5jdGlvbihyZXNwb25zZSkge1xyXG5cdFx0XHRcdHZtLm9yZGVycyA9IHJlc3BvbnNlO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdE9yZGVycy5hcGkucXVlcnkoZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuXHRcdFx0XHR2bS5vcmRlcnMgPSByZXNwb25zZS5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGUudGVjaC5pZCA9PSB1c2VyLl9pZDtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcbn1cclxuXHJcbmFuZ3VsYXJcclxuXHQubW9kdWxlKCdtYWluJylcclxuXHQuY29udHJvbGxlcignbWFpbkN0cmwnLCBbJ1VzZXJTZXJ2JywgJ09yZGVycycsIG1haW5DdHJsXSk7IiwiZnVuY3Rpb24gT3JkZXJDdHJsKE9yZGVycywgQ2xpZW50cywgVXNlcnMsICRodHRwLCAkd2luZG93LCAkc3RhdGVQYXJhbXMpIHtcclxuICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICB2bS5vcmRlck1vZGVsID0ge307XHJcbiAgdm0ub3JkZXJTZWFyY2ggPSB7fTtcclxuICB2bS5lcnJvckluZm8gPSB7XHJcbiAgICBtc2c6IG51bGwsXHJcbiAgICBkYXRhOiBudWxsXHJcbiAgfTtcclxuICB2bS5zdWNjZXNzSW5mbyA9IHtcclxuICAgIG1zZzogbnVsbCxcclxuICAgIGRhdGE6IG51bGxcclxuICB9O1xyXG4gIHZtLnNvbHZlZE9wdCA9IFsnTm8nLCAnU2knXTtcclxuICB2bS5vcmRlclN0YXR1cyA9IFsnQ2FuY2VsYWRhJywgJ0FzaWduYWRhJywgJ0NvbXBsZXRhZGEnXTtcclxuICB2bS5zZWxlY3RlZFRlY2ggPSAnJztcclxuXHJcbiAgdm0uY3JlYXRlID0gZnVuY3Rpb24oZm9ybSkge1xyXG4gICAgLy8gYXNpbmcgYXR0clxyXG4gICAgdm0ub3JkZXJNb2RlbC5jbGllbnQgPSB2bS5jbGllbnREYXRhLl9pZDtcclxuICAgIHZtLm9yZGVyTW9kZWwudGVjaCA9IHtcclxuICAgICAgaWQ6IHZtLnNlbGVjdGVkVGVjaC5faWQsXHJcbiAgICAgIGZpcnN0TmFtZTogdm0uc2VsZWN0ZWRUZWNoLmZpcnN0TmFtZSxcclxuICAgICAgbGFzdE5hbWU6IHZtLnNlbGVjdGVkVGVjaC5sYXN0TmFtZVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbmV3b3JkZXIgPSBuZXcgT3JkZXJzLmFwaSh2bS5vcmRlck1vZGVsKTtcclxuXHJcbiAgICBuZXdvcmRlci4kc2F2ZShmdW5jdGlvbihyZXMpIHtcclxuICAgICAgLy9yZXNldCBmb3JtXHJcbiAgICAgIHZtLm9yZGVyTW9kZWwgPSB7fTtcclxuICAgICAgdm0uY2xpZW50RGF0YSA9IG51bGw7XHJcbiAgICAgIHZtLmNsaWVudFNlYXJjaCA9IHt9O1xyXG4gICAgICB2bS5jbGllbnRMaXN0ID0gbnVsbDtcclxuICAgICAgZm9ybS4kc2V0UHJpc3RpbmUoKTtcclxuICAgICAgZm9ybS4kc2V0VW50b3VjaGVkKCk7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9ICdPcmRlbiBjcmVhZGEgY29uIGV4aXRvJztcclxuICAgICAgdm0uc3VjY2Vzc0luZm8uZGF0YSA9IHJlcztcclxuICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAvL2FsZXJ0XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLmVycm9ySW5mby5tc2cgPSBlcnIuZGF0YTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIHZtLnNlYXJjaENsaWVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHZtLmNsaWVudFNlYXJjaC5udW1iZXIpIHtcclxuICAgICAgdm0uc2VhcmNoV29yZCA9IHZtLmNsaWVudFNlYXJjaC5udW1iZXI7XHJcbiAgICAgIGdldGNsaWVudCh2bS5jbGllbnRTZWFyY2gubnVtYmVyLCAnbnVsbCcpO1xyXG4gICAgfSBlbHNlIGlmICh2bS5jbGllbnRTZWFyY2gubGFzdE5hbWUpIHtcclxuICAgICAgdm0uc2VhcmNoV29yZCA9IHZtLmNsaWVudFNlYXJjaC5sYXN0TmFtZTtcclxuICAgICAgZ2V0Y2xpZW50KCdudWxsJywgdm0uY2xpZW50U2VhcmNoLmxhc3ROYW1lKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5zZWFyY2hPcmRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHZtLm9yZGVyU2VhcmNoLm51bWJlcikge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0ub3JkZXJTZWFyY2gubnVtYmVyO1xyXG4gICAgICBnZXRvcmRlcih2bS5vcmRlclNlYXJjaC5udW1iZXIsICdudWxsJyk7XHJcbiAgICB9IGVsc2UgaWYgKHZtLm9yZGVyU2VhcmNoLmxhc3ROYW1lKSB7XHJcbiAgICAgIHZtLnNlYXJjaFdvcmQgPSB2bS5vcmRlclNlYXJjaC5sYXN0TmFtZTtcclxuICAgICAgZ2V0b3JkZXIoJ251bGwnLCB2bS5vcmRlclNlYXJjaC5sYXN0TmFtZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdm0ucmVtb3ZlID0gZnVuY3Rpb24ob3JkZXIpIHtcclxuICAgIHZhciBjb25maXJtID0gJHdpbmRvdy5jb25maXJtKCdRdWllcmVzIGVsaW1pbmFyIGxhIG9yZGVuIE7CsCAjJyArIG9yZGVyLm51bWJlciArICcgPycpO1xyXG5cclxuICAgIGlmIChjb25maXJtKSB7XHJcbiAgICAgIG9yZGVyLiRyZW1vdmUoKTtcclxuICAgICAgdm0ub3JkZXJMaXN0ID0gdm0ub3JkZXJMaXN0LmZpbHRlcihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgcmV0dXJuIGUuX2lkICE9PSBvcmRlci5faWQ7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHZtLmZpbmRPbmUgPSBmdW5jdGlvbihlZGl0KSB7XHJcbiAgICBPcmRlcnMuYXBpLmdldCh7XHJcbiAgICAgIGlkOiAkc3RhdGVQYXJhbXMuaWRcclxuICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHZtLm9yZGVyTW9kZWwgPSByZXNwb25zZTtcclxuICAgICAgLy8gc2V0IHRlY2ggZm9yIHNlbGVjdCBpbiBlZGl0IGZvcm1cclxuICAgICAgaWYgKGVkaXQpIHtcclxuICAgICAgICB2bS5zZWxlY3RlZFRlY2ggPSB2bS51c2Vycy5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgcmV0dXJuIGUuX2lkID09PSB2bS5vcmRlck1vZGVsLnRlY2guaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdm0uc2VsZWN0ZWRUZWNoID0gdm0uc2VsZWN0ZWRUZWNoWzBdO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICB2bS51cGRhdGUgPSBmdW5jdGlvbihmb3JtKSB7XHJcbiAgICB2bS5vcmRlck1vZGVsLnRlY2ggPSB7XHJcbiAgICAgIGlkOiB2bS5zZWxlY3RlZFRlY2guX2lkLFxyXG4gICAgICBmaXJzdE5hbWU6IHZtLnNlbGVjdGVkVGVjaC5maXJzdE5hbWUsXHJcbiAgICAgIGxhc3ROYW1lOiB2bS5zZWxlY3RlZFRlY2gubGFzdE5hbWVcclxuICAgIH07XHJcblxyXG4gICAgdm0ub3JkZXJNb2RlbC4kdXBkYXRlKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAvL3Jlc2V0IGZvcm1cclxuICAgICAgZm9ybS4kc2V0UHJpc3RpbmUoKTtcclxuICAgICAgZm9ybS4kc2V0VW50b3VjaGVkKCk7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IG51bGw7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLm1zZyA9ICdPcmRlbiBlZGl0YWRhIGNvbiDDqXhpdG8nO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5kYXRhID0gcmVzO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IGVyci5kYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgdm0uZ2V0QWxsVXNlcnMgPSBmdW5jdGlvbigpIHtcclxuICAgIFVzZXJzLmFwaS5xdWVyeShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB2bS51c2VycyA9IHJlc3BvbnNlLmZpbHRlcihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgcmV0dXJuIGUucm9sZSA9PT0gJ1RlY2gnO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIC8vIGZ1bmN0b24gaGVscGVycyAocHJpdmF0ZSlcclxuICBmdW5jdGlvbiBnZXRjbGllbnQobnVtYmVyLCBsYXN0TmFtZSkge1xyXG4gICAgQ2xpZW50cy5zZWFyY2gucXVlcnkoe1xyXG4gICAgICAnaWQnOiBudWxsLFxyXG4gICAgICAnbnVtYmVyJzogbnVtYmVyLFxyXG4gICAgICAnbGFzdE5hbWUnOiBsYXN0TmFtZVxyXG4gICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgdm0uY2xpZW50TGlzdCA9IHJlc3BvbnNlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRvcmRlcihudW1iZXIsIGxhc3ROYW1lKSB7XHJcbiAgICBPcmRlcnMuc2VhcmNoLnF1ZXJ5KHtcclxuICAgICAgJ2lkJzogbnVsbCxcclxuICAgICAgJ251bWJlcic6IG51bWJlcixcclxuICAgICAgJ2xhc3ROYW1lJzogbGFzdE5hbWVcclxuICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHZtLm9yZGVyTGlzdCA9IHJlc3BvbnNlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgLm1vZHVsZSgnb3JkZXInKVxyXG4gIC5jb250cm9sbGVyKCdPcmRlckN0cmwnLCBbJ09yZGVycycsICdDbGllbnRzJywgJ1VzZXJzJywgJyRodHRwJywgJyR3aW5kb3cnLCAnJHN0YXRlUGFyYW1zJywgT3JkZXJDdHJsXSk7XHJcbi8vIGFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuLy8gICAuZGlyZWN0aXZlKCdyZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3InLCBbJyRodHRwJywgJ1VzZXJzJywgZnVuY3Rpb24oJGh0dHAsIFVzZXJzKSB7XHJcblxyXG4vLyAgICAgcmV0dXJuIHtcclxuLy8gICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4vLyAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcclxuLy8gICAgICAgICAvL3ZhciBhcGlVcmwgPSBhdHRycy5yZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3I7XHJcblxyXG4vLyAgICAgICAgIGZ1bmN0aW9uIHNldEFzTG9hZGluZyhib29sKSB7XHJcbi8vICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgncmVjb3JkTG9hZGluZycsICFib29sKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIGZ1bmN0aW9uIHNldEFzQXZhaWxhYmxlKGJvb2wpIHtcclxuLy8gICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRBdmFpbGFibGUnLCBib29sKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIG5nTW9kZWwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xyXG4vLyAgICAgICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHJcbi8vICAgICAgICAgICBzZXRBc0xvYWRpbmcodHJ1ZSk7XHJcbi8vICAgICAgICAgICBzZXRBc0F2YWlsYWJsZShmYWxzZSk7XHJcblxyXG4vLyAgICAgICAgICAgLy8gdXNpbmcgcmVzb3VyY2VcclxuLy8gICAgICAgICAgIHZhciBkYXRhID0gVXNlcnMuc2VhcmNoLmdldCh7XHJcbi8vICAgICAgICAgICAgIG5hbWU6IHZhbHVlXHJcbi8vICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuLy8gICAgICAgICAgICAgaWYgKGRhdGEuZGF0YSA9PT0gJycpIHtcclxuLy8gICAgICAgICAgICAgICBzZXRBc0xvYWRpbmcoZmFsc2UpO1xyXG4vLyAgICAgICAgICAgICAgIHNldEFzQXZhaWxhYmxlKHRydWUpO1xyXG4vLyAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuLy8gICAgICAgICB9KTtcclxuLy8gICAgICAgfVxyXG4vLyAgICAgfTtcclxuLy8gICB9XSk7IiwiYW5ndWxhci5tb2R1bGUoXCJvcmRlclwiKS5kaXJlY3RpdmUoJ2RsS2V5Q29kZScsIGRsS2V5Q29kZSk7XHJcblxyXG5mdW5jdGlvbiBkbEtleUNvZGUoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XHJcbiAgICAgICAgICAgICRlbGVtZW50LmJpbmQoXCJrZXlwcmVzc1wiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleUNvZGUgPSBldmVudC53aGljaCB8fCBldmVudC5rZXlDb2RlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChrZXlDb2RlID09ICRhdHRycy5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRldmFsKCRhdHRycy5kbEtleUNvZGUsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRldmVudDogZXZlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59IiwiZnVuY3Rpb24gVXNlclNlcnYoc3RvcmUsIGp3dEhlbHBlciwgJHdpbmRvdywgVXNlcnMpIHtcclxuXHJcblx0dGhpcy5nZXRDdXJyZW50VXNlckRhdGEgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB0b2tlbiA9IHN0b3JlLmdldCgnand0Jyk7XHJcblx0XHRpZiAodG9rZW4pIHtcclxuXHRcdFx0dmFyIHBheWxvYWQgPSBqd3RIZWxwZXIuZGVjb2RlVG9rZW4odG9rZW4pO1xyXG5cdFx0XHRyZXR1cm4gcGF5bG9hZDtcclxuXHRcdH1lbHNlIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHRoaXMubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZGVjb2RlZCA9IHRoaXMuZ2V0Q3VycmVudFVzZXJEYXRhKCk7XHJcblx0XHRVc2Vycy5sb2dvdXQuZ2V0KHtcclxuXHRcdFx0aWQ6IGRlY29kZWQuX2lkXHJcblx0XHR9LCBmdW5jdGlvbigpIHtcclxuXHRcdFx0c3RvcmUucmVtb3ZlKCdqd3QnKTtcclxuXHRcdFx0JHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy8nO1xyXG5cdFx0fSk7XHJcblx0fTtcclxufVxyXG5cclxuYW5ndWxhclxyXG5cdC5tb2R1bGUoJ3VzZXInKVxyXG5cdC5zZXJ2aWNlKCdVc2VyU2VydicsIFsnc3RvcmUnLCAnand0SGVscGVyJywgJyR3aW5kb3cnLCAnVXNlcnMnLCBVc2VyU2Vydl0pOyIsInZhciBhcHBDb25maWd1cmF0aW9uID0gKGZ1bmN0aW9uKCkge1xyXG5cdHZhciBhcHBOYW1lID0gJ21haW4nO1xyXG5cdHZhciBhcHBEZXBlbmRlbmNpZXMgPSBbJ25nUmVzb3VyY2UnLCAndWkucm91dGVyJywgJ2FuZ3VsYXItand0JywgJ2FuZ3VsYXItc3RvcmFnZScsICduZ01lc3NhZ2VzJ107XHJcblxyXG5cdC8vTWV0aG9kIGZvciBhZGQgbmV3IG1vZHVsZXNcclxuXHR2YXIgcmVnaXN0ZXJNb2R1bGUgPSBmdW5jdGlvbihtb2R1bGVOYW1lLCBtb2R1bGVEZXBlbmRlbmNpZXMpIHtcclxuXHRcdC8vIENyZWF0ZSBtb2R1bGVcclxuXHRcdGFuZ3VsYXIubW9kdWxlKG1vZHVsZU5hbWUsIG1vZHVsZURlcGVuZGVuY2llcyB8fCBbXSk7XHJcblxyXG5cdFx0Ly8gQWRkIHRoZSBuZXcgbW9kdWxlIHRvIHRoZSBhbmd1bGFyIGNvbmZpZyBmaWxlXHJcblx0XHRhbmd1bGFyLm1vZHVsZShhcHBOYW1lKS5yZXF1aXJlcy5wdXNoKG1vZHVsZU5hbWUpO1xyXG5cdH07XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRhcHBOYW1lOiBhcHBOYW1lLFxyXG5cdFx0YXBwRGVwZW5kZW5jaWVzOiBhcHBEZXBlbmRlbmNpZXMsXHJcblx0XHRyZWdpc3Rlck1vZHVsZTogcmVnaXN0ZXJNb2R1bGVcclxuXHR9XHJcbn0pICgpOyIsIi8vRGVmaW5lIG1haW4gbW9kdWxlXHJcbmFuZ3VsYXIubW9kdWxlKGFwcENvbmZpZ3VyYXRpb24uYXBwTmFtZSwgYXBwQ29uZmlndXJhdGlvbi5hcHBEZXBlbmRlbmNpZXMpOyIsImFwcENvbmZpZ3VyYXRpb24ucmVnaXN0ZXJNb2R1bGUoJ2NsaWVudCcpOyIsImFwcENvbmZpZ3VyYXRpb24ucmVnaXN0ZXJNb2R1bGUoJ29yZGVyJyk7IiwiYXBwQ29uZmlndXJhdGlvbi5yZWdpc3Rlck1vZHVsZSgndXNlcicpOyIsImFuZ3VsYXIubW9kdWxlKCdjbGllbnQnKVxyXG4gIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKSB7XHJcblxyXG4gICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgLnN0YXRlKCdjbGllbnRQYW5lbCcsIHtcclxuICAgICAgICB1cmw6ICcvY2xpZW50cycsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2NsaWVudC92aWV3cy9jbGllbnQtcGFuZWwuY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgcmVxdWlyZXNMb2dpbjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSkuc3RhdGUoJ2VkaXRDbGllbnQnLCB7XHJcbiAgICAgICAgdXJsOiAnL2NsaWVudHMvOmlkL2VkaXQnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9jbGllbnQvdmlld3MvZWRpdC1jbGllbnQuY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgcmVxdWlyZXNMb2dpbjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfV0pOyIsIi8vQXJ0aWNsZXMgc2VydmljZSB1c2VkIGZvciBjb21tdW5pY2F0aW5nIHdpdGggdGhlIGFydGljbGVzIFJFU1QgZW5kcG9pbnRzXHJcbmFuZ3VsYXIubW9kdWxlKCdjbGllbnQnKS5mYWN0b3J5KCdDbGllbnRzJywgWyckcmVzb3VyY2UnLCBmdW5jdGlvbigkcmVzb3VyY2UpIHtcclxuXHJcblx0dmFyIGFwaSA9ICRyZXNvdXJjZSgnYXBpL2NsaWVudHMvOmlkJywge1xyXG5cdFx0aWQ6ICdAX2lkJ1xyXG5cdH0sIHtcclxuXHRcdHVwZGF0ZToge1xyXG5cdFx0XHRtZXRob2Q6ICdQVVQnXHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHZhciBzZWFyY2ggPSAkcmVzb3VyY2UoJ2FwaS9jbGllbnRzLzppZC9zZWFyY2gvOm51bWJlci86bGFzdE5hbWUnLCB7XHJcblx0XHRpZDogJ0BfaWQnLFxyXG5cdFx0bnVtYmVyOiAnbnVtYmVyJyxcclxuXHRcdGxhc3ROYW1lOiAnbGFzdE5hbWUnXHJcblx0fSk7XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRhcGk6IGFwaSxcclxuXHRcdHNlYXJjaDogc2VhcmNoXHJcblx0fTtcclxufV0pOyIsImFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21haW4nKVxyXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcbiAgICAgICAgLy8gUmVkaXJlY3QgdG8gaG9tZSB2aWV3IHdoZW4gcm91dGUgbm90IGZvdW5kXHJcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG5cclxuICAgICAgICAvLyBIb21lIHN0YXRlIHJvdXRpbmdcclxuICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgICAuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL21haW4vdmlld3MvZGFzaGJvYXJkLmNsaWVudC52aWV3Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzTG9naW46IHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHVzZSB0aGUgSFRNTDUgSGlzdG9yeSBBUElcclxuICAgICAgICAvLyRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcclxuXHJcblxyXG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdtYWluJylcclxuICAgIC5kaXJlY3RpdmUoJ25nRW50ZXInLCBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYmluZChcImtleWRvd24ga2V5cHJlc3NcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRldmFsKGF0dHJzLm5nRW50ZXIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdldmVudCc6IGV2ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoJ29yZGVyJylcclxuICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xyXG5cclxuICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgIC5zdGF0ZSgnb3JkZXJQYW5lbCcsIHtcclxuICAgICAgICB1cmw6ICcvb3JkZXJzJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvb3JkZXIvdmlld3Mvb3JkZXItcGFuZWwuY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgcmVxdWlyZXNMb2dpbjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSkuc3RhdGUoJ2VkaXRvcmRlcicsIHtcclxuICAgICAgICB1cmw6ICcvb3JkZXJzLzppZC9lZGl0JyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvb3JkZXIvdmlld3MvZWRpdC1vcmRlci5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICByZXF1aXJlc0xvZ2luOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5zdGF0ZSgnb3JkZXJEZXRhaWwnLCB7XHJcbiAgICAgICAgdXJsOiAnL29yZGVycy86aWQnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9vcmRlci92aWV3cy9vcmRlci1kZXRhaWwuY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgcmVxdWlyZXNMb2dpbjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfV0pOyIsIi8vQXJ0aWNsZXMgc2VydmljZSB1c2VkIGZvciBjb21tdW5pY2F0aW5nIHdpdGggdGhlIGFydGljbGVzIFJFU1QgZW5kcG9pbnRzXHJcbmFuZ3VsYXIubW9kdWxlKCdvcmRlcicpLmZhY3RvcnkoJ09yZGVycycsIFsnJHJlc291cmNlJywgZnVuY3Rpb24oJHJlc291cmNlKSB7XHJcblxyXG5cdHZhciBhcGkgPSAkcmVzb3VyY2UoJ2FwaS9vcmRlcnMvOmlkJywge1xyXG5cdFx0aWQ6ICdAX2lkJ1xyXG5cdH0sIHtcclxuXHRcdHVwZGF0ZToge1xyXG5cdFx0XHRtZXRob2Q6ICdQVVQnXHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHZhciBzZWFyY2ggPSAkcmVzb3VyY2UoJ2FwaS9vcmRlcnMvOmlkL3NlYXJjaC86bnVtYmVyLzpsYXN0TmFtZScsIHtcclxuXHRcdGlkOiAnQF9pZCcsXHJcblx0XHRudW1iZXI6ICdudW1iZXInLFxyXG5cdFx0bGFzdE5hbWU6ICdsYXN0TmFtZSdcclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGFwaTogYXBpLFxyXG5cdFx0c2VhcmNoOiBzZWFyY2hcclxuXHR9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ3VzZXInKVxyXG4gIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICdqd3RJbnRlcmNlcHRvclByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgand0SW50ZXJjZXB0b3JQcm92aWRlciwgJGh0dHBQcm92aWRlcikge1xyXG5cclxuICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgIC5zdGF0ZSgnc2lnbmluJywge1xyXG4gICAgICAgIHVybDogJy9zaWduaW4nLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy91c2VyL3ZpZXdzL3NpZ25pbi5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICByZXF1aXJlc0xvZ2luOiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgfSkuc3RhdGUoJ3VzZXJMaXN0Jywge1xyXG4gICAgICAgIHVybDogJy91c2VycycsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL3VzZXIvdmlld3MvdXNlci1saXN0LmNsaWVudC52aWV3Lmh0bWwnLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHJlcXVpcmVzTG9naW46IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pLnN0YXRlKCdlZGl0VXNlcicsIHtcclxuICAgICAgICB1cmw6ICcvdXNlcnMvOmlkL2VkaXQnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy91c2VyL3ZpZXdzL3VzZXItZWRpdC5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICByZXF1aXJlc0xvZ2luOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcblxyXG4gICAgLy9nZXQgdG9rZW4gdG8gbG9jYWwgc3RvcmFnZSBhbmQgc2V0IG9uIHRoZSBoZWFkZXJzXHJcbiAgICBqd3RJbnRlcmNlcHRvclByb3ZpZGVyLnRva2VuR2V0dGVyID0gWydqd3RIZWxwZXInLCAnJGh0dHAnLCAnc3RvcmUnLCAnJHN0YXRlJywgZnVuY3Rpb24oand0SGVscGVyLCAkaHR0cCwgc3RvcmUsICRzdGF0ZSkge1xyXG4gICAgICB2YXIgaWRUb2tlbiA9IHN0b3JlLmdldCgnand0Jyk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKGp3dEhlbHBlci5pc1Rva2VuRXhwaXJlZChpZFRva2VuKSkge1xyXG4gICAgICAgICAgLy8gVGhpcyBpcyBhIHByb21pc2Ugb2YgYSBKV1QgaWRfdG9rZW5cclxuICAgICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6NzAwMC9hcGkvdXNlcnMvcmVmcmVzaCcsXHJcbiAgICAgICAgICAgIC8vIFRoaXMgbWFrZXMgaXQgc28gdGhhdCB0aGlzIHJlcXVlc3QgZG9lc24ndCBzZW5kIHRoZSBKV1RcclxuICAgICAgICAgICAgc2tpcEF1dGhvcml6YXRpb246IHRydWUsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgdG9rZW46IGlkVG9rZW5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgaWRfdG9rZW4gPSByZXNwb25zZS5kYXRhLnRva2VuO1xyXG4gICAgICAgICAgICBzdG9yZS5zZXQoJ2p3dCcsIGlkX3Rva2VuKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlZnJlc1Rva2U6ICcgKyBpZF90b2tlbik7XHJcbiAgICAgICAgICAgIHJldHVybiBpZF90b2tlbjtcclxuICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICBzdG9yZS5yZW1vdmUoJ2p3dCcpO1xyXG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3NpZ25pbicpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGlkVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBzdG9yZS5yZW1vdmUoJ2p3dCcpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfV07XHJcbiAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdqd3RJbnRlcmNlcHRvcicpO1xyXG5cclxuXHJcbiAgfV0pXHJcbiAgLnJ1bihbJyRyb290U2NvcGUnLCAnJHdpbmRvdycsICdzdG9yZScsIGZ1bmN0aW9uKCRyb290U2NvcGUsICR3aW5kb3csIHN0b3JlKSB7XHJcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbihlLCB0bykge1xyXG4gICAgICBpZiAodG8uZGF0YSAmJiB0by5kYXRhLnJlcXVpcmVzTG9naW4pIHtcclxuICAgICAgICBpZiAoIXN0b3JlLmdldCgnand0JykpIHtcclxuICAgICAgICAgICR3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvc2lnbmluIy9zaWduaW4nO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuICAuY29udHJvbGxlcignVXNlckNvbnRyb2xsZXInLCBbJyR3aW5kb3cnLCAnVXNlcnMnLCAnVXNlclNlcnYnLCAnJGh0dHAnLCAnc3RvcmUnLCAnand0SGVscGVyJywgJyRzdGF0ZVBhcmFtcycsICckc3RhdGUnLCBmdW5jdGlvbigkd2luZG93LCBVc2VycywgVXNlclNlcnYsICRodHRwLCBzdG9yZSwgand0SGVscGVyLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSkge1xyXG5cclxuICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICB2bS51c2VyID0ge307XHJcbiAgICB2bS5lcnJvckluZm8gPSB7fTtcclxuXHJcbiAgICB2bS5wdWJsaWNTaWdudXAgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIG5ld1VzZXIgPSBuZXcgVXNlcnMuYXBpKHZtLnVzZXIpO1xyXG5cclxuICAgICAgbmV3VXNlci4kc2F2ZShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHN0b3JlLnNldCgnand0JywgcmVzcG9uc2UudG9rZW4pO1xyXG4gICAgICAgICR3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvcGFuZWwnO1xyXG4gICAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICB2bS5lcnJvckluZm8gPSBlcnIuZGF0YTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZtLnNpZ251cCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2bS51c2VyLnJvbGUgPSAodm0udXNlci5yb2xlKSA/ICdBZG1pbicgOiAnVGVjaCc7XHJcbiAgICAgIHZhciBuZXdVc2VyID0gbmV3IFVzZXJzLmFwaSh2bS51c2VyKTtcclxuXHJcbiAgICAgIG5ld1VzZXIuJHNhdmUoZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAvLyBhZGQgdXNlciB0byB0aGUgbGlzdFxyXG4gICAgICAgIHZtLnVzZXJzLnB1c2godm0udXNlcik7XHJcbiAgICAgICAgLy8gcmVzZXQgZm9ybVxyXG4gICAgICAgIHZtLnVzZXIgPSB7fTtcclxuICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgdm0uZXJyb3JJbmZvID0gZXJyLmRhdGE7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2bS5zaWduaW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHVzZXIgPSBuZXcgVXNlcnMuc2lnbmluKHZtLnVzZXIpO1xyXG5cclxuICAgICAgdXNlci4kc2F2ZShmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgc3RvcmUuc2V0KCdqd3QnLCByZXNwb25zZS50b2tlbik7XHJcbiAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9wYW5lbCMvJztcclxuICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgdm0uZXJyb3JJbmZvID0gZXJyLmRhdGE7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2bS5nZXRBbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgVXNlcnMuYXBpLnF1ZXJ5KGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdm0udXNlcnMgPSByZXNwb25zZS5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgcmV0dXJuIGUuX2lkICE9PSB2bS5jdXJyZW50VXNlci5faWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB2bS5nZXRPbmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgVXNlcnMuYXBpLmdldCh7XHJcbiAgICAgICAgaWQ6ICRzdGF0ZVBhcmFtcy5pZFxyXG4gICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHZtLnVzZXIgPSByZXNwb25zZTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZtLmdldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZtLmN1cnJlbnRVc2VyID0gVXNlclNlcnYuZ2V0Q3VycmVudFVzZXJEYXRhKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZtLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2bS51c2VyLiR1cGRhdGUoZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAkc3RhdGUuZ28oJ3VzZXJMaXN0Jyk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIHZtLmVycm9ySW5mbyA9IGVyci5kYXRhO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdm0ucmVtb3ZlID0gZnVuY3Rpb24odXNlcikge1xyXG4gICAgICB2YXIgY29uZmlybSA9ICR3aW5kb3cuY29uZmlybSgnUXVpZXJlcyBlbGltaW5hciBlbCB1c3VhcmlvICcgKyB1c2VyLmZpcnN0TmFtZSArICcgJyArIHVzZXIubGFzdE5hbWUgKyAnID8nKTtcclxuXHJcbiAgICAgIGlmIChjb25maXJtKSB7XHJcbiAgICAgICAgdXNlci4kcmVtb3ZlKCk7XHJcbiAgICAgICAgdm0udXNlcnMgPSB2bS51c2Vycy5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgcmV0dXJuIGUuX2lkICE9PSB1c2VyLl9pZDtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBcclxuICB9XSk7XHJcblxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3VzZXInKVxyXG4gIC5kaXJlY3RpdmUoXCJjb21wYXJlVG9cIiwgW2Z1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVxdWlyZTogXCJuZ01vZGVsXCIsXHJcbiAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgb3RoZXJNb2RlbFZhbHVlOiBcIj1jb21wYXJlVG9cIlxyXG4gICAgICB9LFxyXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cmlidXRlcywgbmdNb2RlbCkge1xyXG5cclxuICAgICAgICBuZ01vZGVsLiR2YWxpZGF0b3JzLmNvbXBhcmVUbyA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUpIHtcclxuICAgICAgICAgIHJldHVybiBtb2RlbFZhbHVlID09IHNjb3BlLm90aGVyTW9kZWxWYWx1ZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBzY29wZS4kd2F0Y2goXCJvdGhlck1vZGVsVmFsdWVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBuZ01vZGVsLiR2YWxpZGF0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1dKTtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuICAuZGlyZWN0aXZlKCdyZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3InLCBbJyRodHRwJywgJ1VzZXJzJywgZnVuY3Rpb24oJGh0dHAsIFVzZXJzKSB7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcclxuICAgICAgICAvL3ZhciBhcGlVcmwgPSBhdHRycy5yZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3I7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldEFzTG9hZGluZyhib29sKSB7XHJcbiAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgncmVjb3JkTG9hZGluZycsICFib29sKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldEFzQXZhaWxhYmxlKGJvb2wpIHtcclxuICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRBdmFpbGFibGUnLCBib29sKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5nTW9kZWwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHJcbiAgICAgICAgICBzZXRBc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgICBzZXRBc0F2YWlsYWJsZShmYWxzZSk7XHJcblxyXG4gICAgICAgICAgLy8gdXNpbmcgcmVzb3VyY2VcclxuICAgICAgICAgIHZhciBkYXRhID0gVXNlcnMuc2VhcmNoLmdldCh7XHJcbiAgICAgICAgICAgIGVtYWlsOiB2YWx1ZVxyXG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmRhdGEgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICBzZXRBc0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgICAgIHNldEFzQXZhaWxhYmxlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XSk7IiwiLy9BcnRpY2xlcyBzZXJ2aWNlIHVzZWQgZm9yIGNvbW11bmljYXRpbmcgd2l0aCB0aGUgYXJ0aWNsZXMgUkVTVCBlbmRwb2ludHNcclxuYW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdVc2VycycsIFsnJHJlc291cmNlJywgZnVuY3Rpb24oJHJlc291cmNlKSB7XHJcblxyXG4gICAgdmFyIGFwaSA9ICRyZXNvdXJjZSgnYXBpL3VzZXJzLzppZCcsIHtcclxuICAgICAgICBpZDogJ0BfaWQnXHJcbiAgICB9LCB7XHJcbiAgICAgICAgdXBkYXRlOiB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCdcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgc2lnbmluID0gJHJlc291cmNlKCdhcGkvdXNlcnMvc2lnbmluJyk7XHJcblxyXG4gICAgdmFyIGxvZ291dCA9ICRyZXNvdXJjZSgnYXBpL3VzZXJzL2xvZ291dC86aWQnLCB7XHJcbiAgICAgICAgaWQ6ICdAX2lkJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHNlYXJjaCA9ICRyZXNvdXJjZSgnYXBpL3VzZXJzL3NlYXJjaC86ZW1haWwnLCB7XHJcbiAgICAgICAgZW1haWw6ICdAZW1haWwnXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFwaTogYXBpLFxyXG4gICAgICAgIHNpZ25pbjogc2lnbmluLFxyXG4gICAgICAgIGxvZ291dDogbG9nb3V0LFxyXG4gICAgICAgIHNlYXJjaDogc2VhcmNoXHJcbiAgICB9O1xyXG59XHJcbl0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
