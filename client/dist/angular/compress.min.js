function ClientCtrl(e,t,r,n){function i(t,r){e.search.query({id:null,number:t,lastName:r},function(e){o.clientList=e})}var a,o=this;o.clientModel={},o.clientSearch={},o.errorInfo={msg:null,data:null},o.successInfo={msg:null,data:null},o.create=function(t){var r=new e.api(o.clientModel);r.$save(function(e){angular.copy(a,o.clientModel),t.$setPristine(),t.$setUntouched(),o.errorInfo.msg=null,o.successInfo.msg="Cliente creado con exito",o.successInfo.data=e},function(e){o.successInfo.msg=null,o.errorInfo.msg=e.data})},o.search=function(){o.clientSearch.number?(o.searchWord=o.clientSearch.number,i(o.clientSearch.number,"null")):o.clientSearch.lastName&&(o.searchWord=o.clientSearch.lastName,i("null",o.clientSearch.lastName))},o.remove=function(e){var t=r.confirm("Quieres eliminar a "+e.firstName+" "+e.lastName+" ?");t&&e.$remove()},o.findOne=function(){e.api.get({id:n.id},function(e){o.clientModel=e})},o.update=function(e){o.clientModel.$update(function(t){e.$setPristine(),e.$setUntouched(),o.errorInfo.msg=null,o.successInfo.msg="Cliente editado con exito",o.successInfo.data=t},function(e){o.successInfo.msg=null,o.errorInfo.msg=e.data})}}function mainCtrl(e){var t=this,r=e.path();t.isHome="/"==r}function OrderCtrl(e,t,r,n,i,a){function o(e,r){t.search.query({id:null,number:e,lastName:r},function(e){s.clientList=e})}function l(t,r){e.search.query({id:null,number:t,lastName:r},function(e){s.orderList=e})}var s=this;s.orderModel={},s.orderSearch={},s.errorInfo={msg:null,data:null},s.successInfo={msg:null,data:null},s.solvedOpt=["No","Si"],s.orderStatus=["Cancelada","Asignada","Completada"],s.selectedTech="",s.create=function(t){s.orderModel.client=s.clientData._id,s.orderModel.tech={id:s.selectedTech._id,firstName:s.selectedTech.firstName,lastName:s.selectedTech.lastName};var r=new e.api(s.orderModel);r.$save(function(e){s.orderModel={},s.clientData=null,s.clientSearch={},s.clientList=null,t.$setPristine(),t.$setUntouched(),s.errorInfo.msg=null,s.successInfo.msg="Orden creada con exito",s.successInfo.data=e},function(e){s.successInfo.msg=null,s.errorInfo.msg=e.data})},s.searchClient=function(){s.clientSearch.number?(s.searchWord=s.clientSearch.number,o(s.clientSearch.number,"null")):s.clientSearch.lastName&&(s.searchWord=s.clientSearch.lastName,o("null",s.clientSearch.lastName))},s.searchOrder=function(){s.orderSearch.number?(s.searchWord=s.orderSearch.number,l(s.orderSearch.number,"null")):s.orderSearch.lastName&&(s.searchWord=s.orderSearch.lastName,l("null",s.orderSearch.lastName))},s.remove=function(e){var t=i.confirm("Quieres eliminar a "+e.firstName+" "+e.lastName+" ?");t&&e.$remove()},s.findOne=function(t){e.api.get({id:a.id},function(e){s.orderModel=e,t&&(s.selectedTech=s.users.filter(function(e){return e._id===s.orderModel.tech.id}),s.selectedTech=s.selectedTech[0])})},s.update=function(e){s.orderModel.tech={id:s.selectedTech._id,firstName:s.selectedTech.firstName,lastName:s.selectedTech.lastName},s.orderModel.$update(function(t){e.$setPristine(),e.$setUntouched(),s.errorInfo.msg=null,s.successInfo.msg="Orden editada con Ã©xito",s.successInfo.data=t},function(e){s.successInfo.msg=null,s.errorInfo.msg=e.data})},s.getAllUsers=function(){r.api.query(function(e){s.users=e.filter(function(e){return"Tech"===e.role})})}}var appConfiguration=function(){var e="main",t=["ngResource","ui.router","angular-jwt","angular-storage","ngMessages"],r=function(t,r){angular.module(t,r||[]),angular.module(e).requires.push(t)};return{appName:e,appDependencies:t,registerModule:r}}();angular.module(appConfiguration.appName,appConfiguration.appDependencies),appConfiguration.registerModule("client"),appConfiguration.registerModule("order"),appConfiguration.registerModule("user"),angular.module("client").config(["$stateProvider",function(e){e.state("clientPanel",{url:"/clients",templateUrl:"modules/client/views/client-panel.client.view.html"}).state("editClient",{url:"/clients/:id/edit",templateUrl:"modules/client/views/edit-client.client.view.html"}).state("clientDetail",{url:"/clients/:id",templateUrl:"modules/client/views/client-detail.client.view.html",data:{requiresLogin:!0}})}]),angular.module("client").controller("ClientCtrl",["Clients","$http","$window","$stateParams",ClientCtrl]),angular.module("client").factory("Clients",["$resource",function(e){var t=e("api/clients/:id",{id:"@_id"},{update:{method:"PUT"}}),r=e("api/clients/:id/search/:number/:lastName",{id:"@_id",number:"number",lastName:"lastName"});return{api:t,search:r}}]),angular.module("main").config(["$stateProvider","$locationProvider","$urlRouterProvider","jwtInterceptorProvider","$httpProvider",function(e,t,r,n,i){r.otherwise("/"),n.tokenGetter=["jwtHelper","$http","store","$state","$rootScope",function(e,t,r,n,i){var a=r.get("jwt");try{return e.isTokenExpired(a)?t({url:"http://localhost:3000/api/users/refresh",skipAuthorization:!0,method:"POST",data:{token:a}}).then(function(e){var t=e.data.token;return r.set("jwt",t),t},function(e){return r.remove("jwt"),n.go("signin"),!1}):a}catch(o){return r.remove("jwt"),!1}}],i.interceptors.push("jwtInterceptor"),e.state("dashboard",{url:"/",templateUrl:"modules/main/views/dashboard.client.view.html"})}]),angular.module("main").controller("mainCtrl",["$location",mainCtrl]),angular.module("main").directive("ngEnter",function(){return function(e,t,r){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(r.ngEnter,{event:t})}),t.preventDefault())})}}),angular.module("order").config(["$stateProvider",function(e){e.state("orderPanel",{url:"/orders",templateUrl:"modules/order/views/order-panel.client.view.html",data:{requiresLogin:!1}}).state("editorder",{url:"/orders/:id/edit",templateUrl:"modules/order/views/edit-order.client.view.html"}).state("orderDetail",{url:"/orders/:id",templateUrl:"modules/order/views/order-detail.client.view.html"})}]),angular.module("order").controller("OrderCtrl",["Orders","Clients","Users","$http","$window","$stateParams",OrderCtrl]),angular.module("order").directive("ngEnter",function(){return function(e,t,r){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(r.ngEnter,{event:t})}),t.preventDefault())})}}),angular.module("order").factory("Orders",["$resource",function(e){var t=e("api/orders/:id",{id:"@_id"},{update:{method:"PUT"}}),r=e("api/orders/:id/search/:number/:lastName",{id:"@_id",number:"number",lastName:"lastName"});return{api:t,search:r}}]),angular.module("user").config(["$stateProvider",function(e){e.state("signup",{url:"/signup",templateUrl:"modules/user/views/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/user/views/signin.client.view.html"}).state("secureview",{url:"/secureview",templateUrl:"modules/user/views/secureview.client.view.html",data:{requiresLogin:!0}})}]).run(["$rootScope","$window","store","jwtHelper",function(e,t,r,n){e.$on("$stateChangeStart",function(e,n){n.data&&n.data.requiresLogin&&(r.get("jwt")||(t.location.href="/signin"))})}]),angular.module("user").controller("UserController",["$window","Users","$http","store","jwtHelper","$stateParams",function(e,t,r,n,i,a){this.user={},this.signup=function(){var r=new t.api(this.user);r.$save(function(t){console.log(t),n.set("jwt",t.token),e.location.href="/panel"},function(e){console.log(e)})},this.signin=function(){r({url:"http://localhost:3000/api/users/signin",method:"POST",data:this.user}).then(function(t){var r=t.data.token;n.set("jwt",r),e.location.href="/panel"},function(e){this.errMessage=e.data.message})},this.getAll=function(){t.api.query(function(e){this.users=e.filter(function(e){return"Tech"===e.role})})},this.getOne=function(){t.api.get({id:a.id},function(e){this.user=e})},this.isAuth=function(){var e=n.get("jwt");return e?(this.payload=i.decodeToken(e),!0):!1},this.logout=function(){var e=n.get("jwt"),r=i.decodeToken(e);t.logout.get({id:r._id},function(){n.remove("jwt")})}}]),angular.module("user").directive("compareTo",[function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,r,n){n.$validators.compareTo=function(t){return t==e.otherModelValue},e.$watch("otherModelValue",function(){n.$validate()})}}}]),angular.module("user").directive("recordAvailabilityValidator",["$http","Users",function(e,t){return{require:"ngModel",link:function(e,r,n,i){function a(e){i.$setValidity("recordLoading",!e)}function o(e){i.$setValidity("recordAvailable",e)}i.$parsers.push(function(e){if(e&&0!==e.length){a(!0),o(!1);var r=t.search.get({name:e},function(){null===r.data&&(a(!1),o(!0))});return e}})}}}]),angular.module("user").factory("Users",["$resource",function(e){var t=e("api/users/signup/:id",{id:"@_id"}),r=e("api/users/logout/:id",{id:"@_id"}),n=e("api/users/search/:name",{name:"@name"});return{api:t,logout:r,search:n}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9jb250cm9sbGVycy9jbGllbnQuY2xpZW50LmNvbnRyb2xsZXIuanMiLCJtYWluL2NvbnRyb2xsZXJzL21haW4uY2xpZW50LmNvbnRyb2xsZXIuanMiLCJvcmRlci9jb250cm9sbGVycy9vcmRlci5jbGllbnQuY29udHJvbGxlci5qcyIsImNvbmZpZy1hcHAuanMiLCJtYWluLWFwcC5qcyIsImNsaWVudC9jbGllbnQuY2xpZW50LnJlZ2lzdGVyLmpzIiwib3JkZXIvb3JkZXIuY2xpZW50LnJlZ2lzdGVyLmpzIiwidXNlci91c2VyLmNsaWVudC5yZWdpc3Rlci5qcyIsImNsaWVudC9jb25maWcvY2xpZW50LmNsaWVudC5yb3V0ZXMuanMiLCJjbGllbnQvc2VydmljZXMvY2xpZW50LmNsaWVudC5zZXJ2aWNlLmpzIiwibWFpbi9jb25maWcvbWFpbi5jbGllbnQucm91dGVzLmpzIiwibWFpbi9kaXJlY3RpdmVzL25nRW50ZXIuZGlyZWN0aXZlLmpzIiwib3JkZXIvY29uZmlnL29yZGVyLmNsaWVudC5yb3V0ZXMuanMiLCJvcmRlci9kaXJlY3RpdmVzL29yZGVyLmRpcmVjdGl2ZXMuanMiLCJvcmRlci9zZXJ2aWNlcy9vcmRlci5jbGllbnQuc2VydmljZS5qcyIsInVzZXIvY29uZmlnL3VzZXIuY2xpZW50LnJvdXRlcy5qcyIsInVzZXIvY29udHJvbGxlcnMvdXNlci5jbGllbnQuY29udHJvbGxlci5qcyIsInVzZXIvc2VydmljZXMvdXNlci5jbGllbnQuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJDbGllbnRDdHJsIiwiQ2xpZW50cyIsIiRodHRwIiwiJHdpbmRvdyIsIiRzdGF0ZVBhcmFtcyIsImdldENsaWVudCIsIm51bWJlciIsImxhc3ROYW1lIiwic2VhcmNoIiwicXVlcnkiLCJpZCIsInJlc3BvbnNlIiwidm0iLCJjbGllbnRMaXN0IiwibWFzdGVyTW9kZWwiLCJ0aGlzIiwiY2xpZW50TW9kZWwiLCJjbGllbnRTZWFyY2giLCJlcnJvckluZm8iLCJtc2ciLCJkYXRhIiwic3VjY2Vzc0luZm8iLCJjcmVhdGUiLCJmb3JtIiwibmV3Q2xpZW50IiwiYXBpIiwiJHNhdmUiLCJyZXMiLCJhbmd1bGFyIiwiY29weSIsIiRzZXRQcmlzdGluZSIsIiRzZXRVbnRvdWNoZWQiLCJlcnIiLCJzZWFyY2hXb3JkIiwicmVtb3ZlIiwiY2xpZW50IiwiY29uZmlybSIsImZpcnN0TmFtZSIsIiRyZW1vdmUiLCJmaW5kT25lIiwiZ2V0IiwidXBkYXRlIiwiJHVwZGF0ZSIsIm1haW5DdHJsIiwiJGxvY2F0aW9uIiwiY3VycmVudFBhdGgiLCJwYXRoIiwiaXNIb21lIiwiT3JkZXJDdHJsIiwiT3JkZXJzIiwiVXNlcnMiLCJnZXRjbGllbnQiLCJnZXRvcmRlciIsIm9yZGVyTGlzdCIsIm9yZGVyTW9kZWwiLCJvcmRlclNlYXJjaCIsInNvbHZlZE9wdCIsIm9yZGVyU3RhdHVzIiwic2VsZWN0ZWRUZWNoIiwiY2xpZW50RGF0YSIsIl9pZCIsInRlY2giLCJuZXdvcmRlciIsInNlYXJjaENsaWVudCIsInNlYXJjaE9yZGVyIiwib3JkZXIiLCJlZGl0IiwidXNlcnMiLCJmaWx0ZXIiLCJlIiwiZ2V0QWxsVXNlcnMiLCJyb2xlIiwiYXBwQ29uZmlndXJhdGlvbiIsImFwcE5hbWUiLCJhcHBEZXBlbmRlbmNpZXMiLCJyZWdpc3Rlck1vZHVsZSIsIm1vZHVsZU5hbWUiLCJtb2R1bGVEZXBlbmRlbmNpZXMiLCJtb2R1bGUiLCJyZXF1aXJlcyIsInB1c2giLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJyZXF1aXJlc0xvZ2luIiwiY29udHJvbGxlciIsImZhY3RvcnkiLCIkcmVzb3VyY2UiLCJtZXRob2QiLCIkbG9jYXRpb25Qcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsImp3dEludGVyY2VwdG9yUHJvdmlkZXIiLCIkaHR0cFByb3ZpZGVyIiwib3RoZXJ3aXNlIiwidG9rZW5HZXR0ZXIiLCJqd3RIZWxwZXIiLCJzdG9yZSIsIiRzdGF0ZSIsIiRyb290U2NvcGUiLCJpZFRva2VuIiwiaXNUb2tlbkV4cGlyZWQiLCJza2lwQXV0aG9yaXphdGlvbiIsInRva2VuIiwidGhlbiIsImlkX3Rva2VuIiwic2V0IiwiZ28iLCJpbnRlcmNlcHRvcnMiLCJkaXJlY3RpdmUiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsImJpbmQiLCJldmVudCIsIndoaWNoIiwiJGFwcGx5IiwiJGV2YWwiLCJuZ0VudGVyIiwicHJldmVudERlZmF1bHQiLCJydW4iLCIkb24iLCJ0byIsImxvY2F0aW9uIiwiaHJlZiIsInVzZXIiLCJzaWdudXAiLCJuZXdVc2VyIiwiY29uc29sZSIsImxvZyIsInNpZ25pbiIsImVyck1lc3NhZ2UiLCJtZXNzYWdlIiwiZ2V0QWxsIiwiZ2V0T25lIiwiaXNBdXRoIiwicGF5bG9hZCIsImRlY29kZVRva2VuIiwibG9nb3V0IiwiZGVjb2RlZCIsInJlcXVpcmUiLCJvdGhlck1vZGVsVmFsdWUiLCJsaW5rIiwiYXR0cmlidXRlcyIsIm5nTW9kZWwiLCIkdmFsaWRhdG9ycyIsImNvbXBhcmVUbyIsIm1vZGVsVmFsdWUiLCIkd2F0Y2giLCIkdmFsaWRhdGUiLCJzZXRBc0xvYWRpbmciLCJib29sIiwiJHNldFZhbGlkaXR5Iiwic2V0QXNBdmFpbGFibGUiLCIkcGFyc2VycyIsInZhbHVlIiwibGVuZ3RoIiwibmFtZSJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsWUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FpRkEsUUFBQUMsR0FBQUMsRUFBQUMsR0FDQU4sRUFBQU8sT0FBQUMsT0FDQUMsR0FBQSxLQUNBSixPQUFBQSxFQUNBQyxTQUFBQSxHQUNBLFNBQUFJLEdBQ0FDLEVBQUFDLFdBQUFGLElBdEZBLEdBRUFHLEdBRkFGLEVBQUFHLElBSUFILEdBQUFJLGVBQ0FKLEVBQUFLLGdCQUNBTCxFQUFBTSxXQUNBQyxJQUFBLEtBQ0FDLEtBQUEsTUFFQVIsRUFBQVMsYUFDQUYsSUFBQSxLQUNBQyxLQUFBLE1BR0FSLEVBQUFVLE9B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LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQ2xpZW50Q3RybChDbGllbnRzLCAkaHR0cCwgJHdpbmRvdywgJHN0YXRlUGFyYW1zKSB7XHJcbiAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgdmFyIG1hc3Rlck1vZGVsO1xyXG5cclxuICB2bS5jbGllbnRNb2RlbCA9IHt9O1xyXG4gIHZtLmNsaWVudFNlYXJjaCA9IHt9O1xyXG4gIHZtLmVycm9ySW5mbyA9IHtcclxuICAgIG1zZzogbnVsbCxcclxuICAgIGRhdGE6IG51bGxcclxuICB9O1xyXG4gIHZtLnN1Y2Nlc3NJbmZvID0ge1xyXG4gICAgbXNnOiBudWxsLFxyXG4gICAgZGF0YTogbnVsbFxyXG4gIH07XHJcblxyXG4gIHZtLmNyZWF0ZSA9IGZ1bmN0aW9uKGZvcm0pIHtcclxuICAgIHZhciBuZXdDbGllbnQgPSBuZXcgQ2xpZW50cy5hcGkodm0uY2xpZW50TW9kZWwpO1xyXG5cclxuICAgIG5ld0NsaWVudC4kc2F2ZShmdW5jdGlvbihyZXMpIHtcclxuICAgICAgLy9yZXNldCBmb3JtXHJcbiAgICAgIGFuZ3VsYXIuY29weShtYXN0ZXJNb2RlbCwgdm0uY2xpZW50TW9kZWwpO1xyXG4gICAgICBmb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICBmb3JtLiRzZXRVbnRvdWNoZWQoKTtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gJ0NsaWVudGUgY3JlYWRvIGNvbiBleGl0byc7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLmRhdGEgPSByZXM7XHJcbiAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5zdWNjZXNzSW5mby5tc2cgPSBudWxsO1xyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gZXJyLmRhdGE7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICB2bS5zZWFyY2ggPSBmdW5jdGlvbigpIHtcclxuICAgIGlmICh2bS5jbGllbnRTZWFyY2gubnVtYmVyKSB7XHJcbiAgICAgIHZtLnNlYXJjaFdvcmQgPSB2bS5jbGllbnRTZWFyY2gubnVtYmVyO1xyXG4gICAgICBnZXRDbGllbnQodm0uY2xpZW50U2VhcmNoLm51bWJlciwgJ251bGwnKTtcclxuICAgIH0gZWxzZSBpZiAodm0uY2xpZW50U2VhcmNoLmxhc3ROYW1lKSB7XHJcbiAgICAgIHZtLnNlYXJjaFdvcmQgPSB2bS5jbGllbnRTZWFyY2gubGFzdE5hbWU7XHJcbiAgICAgIGdldENsaWVudCgnbnVsbCcsIHZtLmNsaWVudFNlYXJjaC5sYXN0TmFtZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdm0ucmVtb3ZlID0gZnVuY3Rpb24oY2xpZW50KSB7XHJcbiAgICB2YXIgY29uZmlybSA9ICR3aW5kb3cuY29uZmlybSgnUXVpZXJlcyBlbGltaW5hciBhICcgKyBjbGllbnQuZmlyc3ROYW1lICsgJyAnICsgY2xpZW50Lmxhc3ROYW1lICsgJyA/Jyk7XHJcblxyXG4gICAgaWYgKGNvbmZpcm0pIHtcclxuICAgICAgY2xpZW50LiRyZW1vdmUoKTtcclxuICAgICAgICAvLyB2bS5jbGllbnRMaXN0ID0gdm0uY2xpZW50TGlzdC5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIC8vICAgcmV0dXJuIGUuX2lkICE9PSBjbGllbnQuX2lkO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHZtLmZpbmRPbmUgPSBmdW5jdGlvbigpIHtcclxuICAgIENsaWVudHMuYXBpLmdldCh7XHJcbiAgICAgIGlkOiAkc3RhdGVQYXJhbXMuaWRcclxuICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHZtLmNsaWVudE1vZGVsID0gcmVzcG9uc2U7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICB2bS51cGRhdGUgPSBmdW5jdGlvbihmb3JtKXtcclxuICAgIHZtLmNsaWVudE1vZGVsLiR1cGRhdGUoZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgIC8vcmVzZXQgZm9ybVxyXG4gICAgICBmb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICBmb3JtLiRzZXRVbnRvdWNoZWQoKTtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gJ0NsaWVudGUgZWRpdGFkbyBjb24gZXhpdG8nO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5kYXRhID0gcmVzO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IGVyci5kYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gZnVuY3RvbiBoZWxwZXJzIChwcml2YXRlKVxyXG4gIGZ1bmN0aW9uIGdldENsaWVudChudW1iZXIsIGxhc3ROYW1lKSB7XHJcbiAgICBDbGllbnRzLnNlYXJjaC5xdWVyeSh7XHJcbiAgICAgICdpZCc6IG51bGwsXHJcbiAgICAgICdudW1iZXInOiBudW1iZXIsXHJcbiAgICAgICdsYXN0TmFtZSc6IGxhc3ROYW1lXHJcbiAgICB9LCBmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgIHZtLmNsaWVudExpc3QgPSByZXNwb25zZTtcclxuICAgIH0pOyAgXHJcbiAgfVxyXG5cclxufVxyXG5cclxuYW5ndWxhclxyXG4gIC5tb2R1bGUoJ2NsaWVudCcpXHJcbiAgLmNvbnRyb2xsZXIoJ0NsaWVudEN0cmwnLCBbJ0NsaWVudHMnLCAnJGh0dHAnLCAnJHdpbmRvdycsICckc3RhdGVQYXJhbXMnLCBDbGllbnRDdHJsXSk7XHJcbi8vIGFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuLy8gICAuZGlyZWN0aXZlKCdyZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3InLCBbJyRodHRwJywgJ1VzZXJzJywgZnVuY3Rpb24oJGh0dHAsIFVzZXJzKSB7XHJcblxyXG4vLyAgICAgcmV0dXJuIHtcclxuLy8gICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4vLyAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcclxuLy8gICAgICAgICAvL3ZhciBhcGlVcmwgPSBhdHRycy5yZWNvcmRBdmFpbGFiaWxpdHlWYWxpZGF0b3I7XHJcblxyXG4vLyAgICAgICAgIGZ1bmN0aW9uIHNldEFzTG9hZGluZyhib29sKSB7XHJcbi8vICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgncmVjb3JkTG9hZGluZycsICFib29sKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIGZ1bmN0aW9uIHNldEFzQXZhaWxhYmxlKGJvb2wpIHtcclxuLy8gICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRBdmFpbGFibGUnLCBib29sKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIG5nTW9kZWwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xyXG4vLyAgICAgICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHJcbi8vICAgICAgICAgICBzZXRBc0xvYWRpbmcodHJ1ZSk7XHJcbi8vICAgICAgICAgICBzZXRBc0F2YWlsYWJsZShmYWxzZSk7XHJcblxyXG4vLyAgICAgICAgICAgLy8gdXNpbmcgcmVzb3VyY2VcclxuLy8gICAgICAgICAgIHZhciBkYXRhID0gVXNlcnMuc2VhcmNoLmdldCh7XHJcbi8vICAgICAgICAgICAgIG5hbWU6IHZhbHVlXHJcbi8vICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuLy8gICAgICAgICAgICAgaWYgKGRhdGEuZGF0YSA9PT0gJycpIHtcclxuLy8gICAgICAgICAgICAgICBzZXRBc0xvYWRpbmcoZmFsc2UpO1xyXG4vLyAgICAgICAgICAgICAgIHNldEFzQXZhaWxhYmxlKHRydWUpO1xyXG4vLyAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuLy8gICAgICAgICB9KTtcclxuLy8gICAgICAgfVxyXG4vLyAgICAgfTtcclxuLy8gICB9XSk7IiwiZnVuY3Rpb24gbWFpbkN0cmwoJGxvY2F0aW9uKSB7XHJcblx0dmFyIHZtID0gdGhpcztcclxuXHJcblx0dmFyIGN1cnJlbnRQYXRoID0gJGxvY2F0aW9uLnBhdGgoKTtcclxuXHR2bS5pc0hvbWUgPSAoY3VycmVudFBhdGggPT0gJy8nKSA/IHRydWUgOiBmYWxzZTtcclxufVxyXG5cclxuYW5ndWxhclxyXG5cdC5tb2R1bGUoJ21haW4nKVxyXG5cdC5jb250cm9sbGVyKCdtYWluQ3RybCcsIFsnJGxvY2F0aW9uJywgbWFpbkN0cmxdKTsiLCJmdW5jdGlvbiBPcmRlckN0cmwoT3JkZXJzLCBDbGllbnRzLCBVc2VycywgJGh0dHAsICR3aW5kb3csICRzdGF0ZVBhcmFtcykge1xyXG4gIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gIHZtLm9yZGVyTW9kZWwgPSB7fTtcclxuICB2bS5vcmRlclNlYXJjaCA9IHt9O1xyXG4gIHZtLmVycm9ySW5mbyA9IHtcclxuICAgIG1zZzogbnVsbCxcclxuICAgIGRhdGE6IG51bGxcclxuICB9O1xyXG4gIHZtLnN1Y2Nlc3NJbmZvID0ge1xyXG4gICAgbXNnOiBudWxsLFxyXG4gICAgZGF0YTogbnVsbFxyXG4gIH07XHJcbiAgdm0uc29sdmVkT3B0ID0gWydObycsICdTaSddO1xyXG4gIHZtLm9yZGVyU3RhdHVzID0gWydDYW5jZWxhZGEnLCAnQXNpZ25hZGEnLCAnQ29tcGxldGFkYSddO1xyXG4gIHZtLnNlbGVjdGVkVGVjaCA9ICcnO1xyXG5cclxuICB2bS5jcmVhdGUgPSBmdW5jdGlvbihmb3JtKSB7XHJcbiAgICAvLyBhc2luZyBhdHRyXHJcbiAgICB2bS5vcmRlck1vZGVsLmNsaWVudCA9IHZtLmNsaWVudERhdGEuX2lkO1xyXG4gICAgdm0ub3JkZXJNb2RlbC50ZWNoID0ge1xyXG4gICAgICBpZDogdm0uc2VsZWN0ZWRUZWNoLl9pZCxcclxuICAgICAgZmlyc3ROYW1lOiB2bS5zZWxlY3RlZFRlY2guZmlyc3ROYW1lLFxyXG4gICAgICBsYXN0TmFtZTogdm0uc2VsZWN0ZWRUZWNoLmxhc3ROYW1lXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBuZXdvcmRlciA9IG5ldyBPcmRlcnMuYXBpKHZtLm9yZGVyTW9kZWwpO1xyXG5cclxuICAgIG5ld29yZGVyLiRzYXZlKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAvL3Jlc2V0IGZvcm1cclxuICAgICAgdm0ub3JkZXJNb2RlbCA9IHt9O1xyXG4gICAgICB2bS5jbGllbnREYXRhID0gbnVsbDtcclxuICAgICAgdm0uY2xpZW50U2VhcmNoID0ge307XHJcbiAgICAgIHZtLmNsaWVudExpc3QgPSBudWxsO1xyXG4gICAgICBmb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICBmb3JtLiRzZXRVbnRvdWNoZWQoKTtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gJ09yZGVuIGNyZWFkYSBjb24gZXhpdG8nO1xyXG4gICAgICB2bS5zdWNjZXNzSW5mby5kYXRhID0gcmVzO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIC8vYWxlcnRcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uZXJyb3JJbmZvLm1zZyA9IGVyci5kYXRhO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgdm0uc2VhcmNoQ2xpZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodm0uY2xpZW50U2VhcmNoLm51bWJlcikge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0uY2xpZW50U2VhcmNoLm51bWJlcjtcclxuICAgICAgZ2V0Y2xpZW50KHZtLmNsaWVudFNlYXJjaC5udW1iZXIsICdudWxsJyk7XHJcbiAgICB9IGVsc2UgaWYgKHZtLmNsaWVudFNlYXJjaC5sYXN0TmFtZSkge1xyXG4gICAgICB2bS5zZWFyY2hXb3JkID0gdm0uY2xpZW50U2VhcmNoLmxhc3ROYW1lO1xyXG4gICAgICBnZXRjbGllbnQoJ251bGwnLCB2bS5jbGllbnRTZWFyY2gubGFzdE5hbWUpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHZtLnNlYXJjaE9yZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodm0ub3JkZXJTZWFyY2gubnVtYmVyKSB7XHJcbiAgICAgIHZtLnNlYXJjaFdvcmQgPSB2bS5vcmRlclNlYXJjaC5udW1iZXI7XHJcbiAgICAgIGdldG9yZGVyKHZtLm9yZGVyU2VhcmNoLm51bWJlciwgJ251bGwnKTtcclxuICAgIH0gZWxzZSBpZiAodm0ub3JkZXJTZWFyY2gubGFzdE5hbWUpIHtcclxuICAgICAgdm0uc2VhcmNoV29yZCA9IHZtLm9yZGVyU2VhcmNoLmxhc3ROYW1lO1xyXG4gICAgICBnZXRvcmRlcignbnVsbCcsIHZtLm9yZGVyU2VhcmNoLmxhc3ROYW1lKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5yZW1vdmUgPSBmdW5jdGlvbihvcmRlcikge1xyXG4gICAgdmFyIGNvbmZpcm0gPSAkd2luZG93LmNvbmZpcm0oJ1F1aWVyZXMgZWxpbWluYXIgYSAnICsgb3JkZXIuZmlyc3ROYW1lICsgJyAnICsgb3JkZXIubGFzdE5hbWUgKyAnID8nKTtcclxuXHJcbiAgICBpZiAoY29uZmlybSkge1xyXG4gICAgICBvcmRlci4kcmVtb3ZlKCk7XHJcbiAgICAgIC8vIHZtLm9yZGVyTGlzdCA9IHZtLm9yZGVyTGlzdC5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAvLyAgIHJldHVybiBlLl9pZCAhPT0gb3JkZXIuX2lkO1xyXG4gICAgICAvLyB9KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2bS5maW5kT25lID0gZnVuY3Rpb24oZWRpdCkge1xyXG4gICAgT3JkZXJzLmFwaS5nZXQoe1xyXG4gICAgICBpZDogJHN0YXRlUGFyYW1zLmlkXHJcbiAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB2bS5vcmRlck1vZGVsID0gcmVzcG9uc2U7XHJcbiAgICAgIC8vIHNldCB0ZWNoIGZvciBzZWxlY3QgaW4gZWRpdCBmb3JtXHJcbiAgICAgIGlmKGVkaXQpe1xyXG4gICAgICAgIHZtLnNlbGVjdGVkVGVjaCA9IHZtLnVzZXJzLmZpbHRlcihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICByZXR1cm4gZS5faWQgPT09IHZtLm9yZGVyTW9kZWwudGVjaC5pZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2bS5zZWxlY3RlZFRlY2ggPSB2bS5zZWxlY3RlZFRlY2hbMF07XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIHZtLnVwZGF0ZSA9IGZ1bmN0aW9uKGZvcm0pIHtcclxuICAgIHZtLm9yZGVyTW9kZWwudGVjaCA9IHtcclxuICAgICAgaWQ6IHZtLnNlbGVjdGVkVGVjaC5faWQsXHJcbiAgICAgIGZpcnN0TmFtZTogdm0uc2VsZWN0ZWRUZWNoLmZpcnN0TmFtZSxcclxuICAgICAgbGFzdE5hbWU6IHZtLnNlbGVjdGVkVGVjaC5sYXN0TmFtZVxyXG4gICAgfTtcclxuXHJcbiAgICB2bS5vcmRlck1vZGVsLiR1cGRhdGUoZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgIC8vcmVzZXQgZm9ybVxyXG4gICAgICBmb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICBmb3JtLiRzZXRVbnRvdWNoZWQoKTtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gbnVsbDtcclxuICAgICAgdm0uc3VjY2Vzc0luZm8ubXNnID0gJ09yZGVuIGVkaXRhZGEgY29uIMOpeGl0byc7XHJcbiAgICAgIHZtLnN1Y2Nlc3NJbmZvLmRhdGEgPSByZXM7XHJcbiAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgLy9hbGVydFxyXG4gICAgICB2bS5zdWNjZXNzSW5mby5tc2cgPSBudWxsO1xyXG4gICAgICB2bS5lcnJvckluZm8ubXNnID0gZXJyLmRhdGE7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICB2bS5nZXRBbGxVc2VycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgVXNlcnMuYXBpLnF1ZXJ5KGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHZtLnVzZXJzID0gcmVzcG9uc2UuZmlsdGVyKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICByZXR1cm4gZS5yb2xlID09PSAnVGVjaCc7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gZnVuY3RvbiBoZWxwZXJzIChwcml2YXRlKVxyXG4gIGZ1bmN0aW9uIGdldGNsaWVudChudW1iZXIsIGxhc3ROYW1lKSB7XHJcbiAgICBDbGllbnRzLnNlYXJjaC5xdWVyeSh7XHJcbiAgICAgICdpZCc6IG51bGwsXHJcbiAgICAgICdudW1iZXInOiBudW1iZXIsXHJcbiAgICAgICdsYXN0TmFtZSc6IGxhc3ROYW1lXHJcbiAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB2bS5jbGllbnRMaXN0ID0gcmVzcG9uc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldG9yZGVyKG51bWJlciwgbGFzdE5hbWUpIHtcclxuICAgIE9yZGVycy5zZWFyY2gucXVlcnkoe1xyXG4gICAgICAnaWQnOiBudWxsLFxyXG4gICAgICAnbnVtYmVyJzogbnVtYmVyLFxyXG4gICAgICAnbGFzdE5hbWUnOiBsYXN0TmFtZVxyXG4gICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgdm0ub3JkZXJMaXN0ID0gcmVzcG9uc2U7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFuZ3VsYXJcclxuICAubW9kdWxlKCdvcmRlcicpXHJcbiAgLmNvbnRyb2xsZXIoJ09yZGVyQ3RybCcsIFsnT3JkZXJzJywgJ0NsaWVudHMnLCAnVXNlcnMnLCAnJGh0dHAnLCAnJHdpbmRvdycsICckc3RhdGVQYXJhbXMnLCBPcmRlckN0cmxdKTtcclxuLy8gYW5ndWxhci5tb2R1bGUoJ3VzZXInKVxyXG4vLyAgIC5kaXJlY3RpdmUoJ3JlY29yZEF2YWlsYWJpbGl0eVZhbGlkYXRvcicsIFsnJGh0dHAnLCAnVXNlcnMnLCBmdW5jdGlvbigkaHR0cCwgVXNlcnMpIHtcclxuXHJcbi8vICAgICByZXR1cm4ge1xyXG4vLyAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbi8vICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xyXG4vLyAgICAgICAgIC8vdmFyIGFwaVVybCA9IGF0dHJzLnJlY29yZEF2YWlsYWJpbGl0eVZhbGlkYXRvcjtcclxuXHJcbi8vICAgICAgICAgZnVuY3Rpb24gc2V0QXNMb2FkaW5nKGJvb2wpIHtcclxuLy8gICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRMb2FkaW5nJywgIWJvb2wpO1xyXG4vLyAgICAgICAgIH1cclxuXHJcbi8vICAgICAgICAgZnVuY3Rpb24gc2V0QXNBdmFpbGFibGUoYm9vbCkge1xyXG4vLyAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3JlY29yZEF2YWlsYWJsZScsIGJvb2wpO1xyXG4vLyAgICAgICAgIH1cclxuXHJcbi8vICAgICAgICAgbmdNb2RlbC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbi8vICAgICAgICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG5cclxuLy8gICAgICAgICAgIHNldEFzTG9hZGluZyh0cnVlKTtcclxuLy8gICAgICAgICAgIHNldEFzQXZhaWxhYmxlKGZhbHNlKTtcclxuXHJcbi8vICAgICAgICAgICAvLyB1c2luZyByZXNvdXJjZVxyXG4vLyAgICAgICAgICAgdmFyIGRhdGEgPSBVc2Vycy5zZWFyY2guZ2V0KHtcclxuLy8gICAgICAgICAgICAgbmFtZTogdmFsdWVcclxuLy8gICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4vLyAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhID09PSAnJykge1xyXG4vLyAgICAgICAgICAgICAgIHNldEFzTG9hZGluZyhmYWxzZSk7XHJcbi8vICAgICAgICAgICAgICAgc2V0QXNBdmFpbGFibGUodHJ1ZSk7XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgIH0pO1xyXG4vLyAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4vLyAgICAgICAgIH0pO1xyXG4vLyAgICAgICB9XHJcbi8vICAgICB9O1xyXG4vLyAgIH1dKTsiLCJ2YXIgYXBwQ29uZmlndXJhdGlvbiA9IChmdW5jdGlvbigpIHtcclxuXHR2YXIgYXBwTmFtZSA9ICdtYWluJztcclxuXHR2YXIgYXBwRGVwZW5kZW5jaWVzID0gWyduZ1Jlc291cmNlJywgJ3VpLnJvdXRlcicsICdhbmd1bGFyLWp3dCcsICdhbmd1bGFyLXN0b3JhZ2UnLCAnbmdNZXNzYWdlcyddO1xyXG5cclxuXHQvL01ldGhvZCBmb3IgYWRkIG5ldyBtb2R1bGVzXHJcblx0dmFyIHJlZ2lzdGVyTW9kdWxlID0gZnVuY3Rpb24obW9kdWxlTmFtZSwgbW9kdWxlRGVwZW5kZW5jaWVzKSB7XHJcblx0XHQvLyBDcmVhdGUgbW9kdWxlXHJcblx0XHRhbmd1bGFyLm1vZHVsZShtb2R1bGVOYW1lLCBtb2R1bGVEZXBlbmRlbmNpZXMgfHwgW10pO1xyXG5cclxuXHRcdC8vIEFkZCB0aGUgbmV3IG1vZHVsZSB0byB0aGUgYW5ndWxhciBjb25maWcgZmlsZVxyXG5cdFx0YW5ndWxhci5tb2R1bGUoYXBwTmFtZSkucmVxdWlyZXMucHVzaChtb2R1bGVOYW1lKTtcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0YXBwTmFtZTogYXBwTmFtZSxcclxuXHRcdGFwcERlcGVuZGVuY2llczogYXBwRGVwZW5kZW5jaWVzLFxyXG5cdFx0cmVnaXN0ZXJNb2R1bGU6IHJlZ2lzdGVyTW9kdWxlXHJcblx0fVxyXG59KSAoKTsiLCIvL0RlZmluZSBtYWluIG1vZHVsZVxyXG5hbmd1bGFyLm1vZHVsZShhcHBDb25maWd1cmF0aW9uLmFwcE5hbWUsIGFwcENvbmZpZ3VyYXRpb24uYXBwRGVwZW5kZW5jaWVzKTsiLCJhcHBDb25maWd1cmF0aW9uLnJlZ2lzdGVyTW9kdWxlKCdjbGllbnQnKTsiLCJhcHBDb25maWd1cmF0aW9uLnJlZ2lzdGVyTW9kdWxlKCdvcmRlcicpOyIsImFwcENvbmZpZ3VyYXRpb24ucmVnaXN0ZXJNb2R1bGUoJ3VzZXInKTsiLCJhbmd1bGFyLm1vZHVsZSgnY2xpZW50JylcclxuICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xyXG5cclxuICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgIC5zdGF0ZSgnY2xpZW50UGFuZWwnLCB7XHJcbiAgICAgICAgdXJsOiAnL2NsaWVudHMnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9jbGllbnQvdmlld3MvY2xpZW50LXBhbmVsLmNsaWVudC52aWV3Lmh0bWwnXHJcbiAgICAgIH0pLnN0YXRlKCdlZGl0Q2xpZW50Jywge1xyXG4gICAgICAgIHVybDogJy9jbGllbnRzLzppZC9lZGl0JyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvY2xpZW50L3ZpZXdzL2VkaXQtY2xpZW50LmNsaWVudC52aWV3Lmh0bWwnLFxyXG4gICAgICB9KS5zdGF0ZSgnY2xpZW50RGV0YWlsJywge1xyXG4gICAgICAgIHVybDogJy9jbGllbnRzLzppZCcsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2NsaWVudC92aWV3cy9jbGllbnQtZGV0YWlsLmNsaWVudC52aWV3Lmh0bWwnLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHJlcXVpcmVzTG9naW46IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gIH1dKTsiLCIvL0FydGljbGVzIHNlcnZpY2UgdXNlZCBmb3IgY29tbXVuaWNhdGluZyB3aXRoIHRoZSBhcnRpY2xlcyBSRVNUIGVuZHBvaW50c1xyXG5hbmd1bGFyLm1vZHVsZSgnY2xpZW50JykuZmFjdG9yeSgnQ2xpZW50cycsIFsnJHJlc291cmNlJywgZnVuY3Rpb24oJHJlc291cmNlKSB7XHJcblxyXG5cdHZhciBhcGkgPSAkcmVzb3VyY2UoJ2FwaS9jbGllbnRzLzppZCcsIHtcclxuXHRcdGlkOiAnQF9pZCdcclxuXHR9LCB7XHJcblx0XHR1cGRhdGU6IHtcclxuXHRcdFx0bWV0aG9kOiAnUFVUJ1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHR2YXIgc2VhcmNoID0gJHJlc291cmNlKCdhcGkvY2xpZW50cy86aWQvc2VhcmNoLzpudW1iZXIvOmxhc3ROYW1lJywge1xyXG5cdFx0aWQ6ICdAX2lkJyxcclxuXHRcdG51bWJlcjogJ251bWJlcicsXHJcblx0XHRsYXN0TmFtZTogJ2xhc3ROYW1lJ1xyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0YXBpOiBhcGksXHJcblx0XHRzZWFyY2g6IHNlYXJjaFxyXG5cdH07XHJcbn1dKTsiLCJhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWluJylcclxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCAnand0SW50ZXJjZXB0b3JQcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsIGp3dEludGVyY2VwdG9yUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpIHtcclxuICAgICAgICAvLyBSZWRpcmVjdCB0byBob21lIHZpZXcgd2hlbiByb3V0ZSBub3QgZm91bmRcclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XHJcblxyXG4gICAgICAgIC8vIHVzZSB0aGUgSFRNTDUgSGlzdG9yeSBBUElcclxuICAgICAgICAvLyRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcclxuXHJcbiAgICAgICAgLy8gZ2V0IHRva2VuIHRvIGxvY2FsIHN0b3JhZ2UgYW5kIHNldCBvbiB0aGUgaGVhZGVyc1xyXG4gICAgICAgIGp3dEludGVyY2VwdG9yUHJvdmlkZXIudG9rZW5HZXR0ZXIgPSBbJ2p3dEhlbHBlcicsICckaHR0cCcsICdzdG9yZScsICckc3RhdGUnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKGp3dEhlbHBlciwgJGh0dHAsIHN0b3JlLCAkc3RhdGUsICRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgdmFyIGlkVG9rZW4gPSBzdG9yZS5nZXQoJ2p3dCcpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGp3dEhlbHBlci5pc1Rva2VuRXhwaXJlZChpZFRva2VuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBwcm9taXNlIG9mIGEgSldUIGlkX3Rva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2Vycy9yZWZyZXNoJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBtYWtlcyBpdCBzbyB0aGF0IHRoaXMgcmVxdWVzdCBkb2Vzbid0IHNlbmQgdGhlIEpXVFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBza2lwQXV0aG9yaXphdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiBpZFRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZF90b2tlbiA9IHJlc3BvbnNlLmRhdGEudG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlLnNldCgnand0JywgaWRfdG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWRfdG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlLnJlbW92ZSgnand0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnc2lnbmluJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkVG9rZW47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgc3RvcmUucmVtb3ZlKCdqd3QnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1dO1xyXG4gICAgICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2p3dEludGVyY2VwdG9yJyk7XHJcblxyXG4gICAgICAgIC8vIEhvbWUgc3RhdGUgcm91dGluZ1xyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvbWFpbi92aWV3cy9kYXNoYm9hcmQuY2xpZW50LnZpZXcuaHRtbCdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XSk7IiwiYW5ndWxhci5tb2R1bGUoJ21haW4nKVxyXG4gICAgLmRpcmVjdGl2ZSgnbmdFbnRlcicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKFwia2V5ZG93biBrZXlwcmVzc1wiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGV2YWwoYXR0cnMubmdFbnRlciwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V2ZW50JzogZXZlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnb3JkZXInKVxyXG4gIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKSB7XHJcblxyXG4gICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgLnN0YXRlKCdvcmRlclBhbmVsJywge1xyXG4gICAgICAgIHVybDogJy9vcmRlcnMnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9vcmRlci92aWV3cy9vcmRlci1wYW5lbC5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICByZXF1aXJlc0xvZ2luOiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgfSkuc3RhdGUoJ2VkaXRvcmRlcicsIHtcclxuICAgICAgICB1cmw6ICcvb3JkZXJzLzppZC9lZGl0JyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvb3JkZXIvdmlld3MvZWRpdC1vcmRlci5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgfSkuc3RhdGUoJ29yZGVyRGV0YWlsJywge1xyXG4gICAgICAgIHVybDogJy9vcmRlcnMvOmlkJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvb3JkZXIvdmlld3Mvb3JkZXItZGV0YWlsLmNsaWVudC52aWV3Lmh0bWwnXHJcbiAgICAgIH0pO1xyXG4gIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnb3JkZXInKVxyXG4gICAgLmRpcmVjdGl2ZSgnbmdFbnRlcicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKFwia2V5ZG93biBrZXlwcmVzc1wiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGV2YWwoYXR0cnMubmdFbnRlciwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V2ZW50JzogZXZlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCIvL0FydGljbGVzIHNlcnZpY2UgdXNlZCBmb3IgY29tbXVuaWNhdGluZyB3aXRoIHRoZSBhcnRpY2xlcyBSRVNUIGVuZHBvaW50c1xyXG5hbmd1bGFyLm1vZHVsZSgnb3JkZXInKS5mYWN0b3J5KCdPcmRlcnMnLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uKCRyZXNvdXJjZSkge1xyXG5cclxuXHR2YXIgYXBpID0gJHJlc291cmNlKCdhcGkvb3JkZXJzLzppZCcsIHtcclxuXHRcdGlkOiAnQF9pZCdcclxuXHR9LCB7XHJcblx0XHR1cGRhdGU6IHtcclxuXHRcdFx0bWV0aG9kOiAnUFVUJ1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHR2YXIgc2VhcmNoID0gJHJlc291cmNlKCdhcGkvb3JkZXJzLzppZC9zZWFyY2gvOm51bWJlci86bGFzdE5hbWUnLCB7XHJcblx0XHRpZDogJ0BfaWQnLFxyXG5cdFx0bnVtYmVyOiAnbnVtYmVyJyxcclxuXHRcdGxhc3ROYW1lOiAnbGFzdE5hbWUnXHJcblx0fSk7XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRhcGk6IGFwaSxcclxuXHRcdHNlYXJjaDogc2VhcmNoXHJcblx0fTtcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCd1c2VyJylcclxuICAuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xyXG5cclxuICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgIC5zdGF0ZSgnc2lnbnVwJywge1xyXG4gICAgICAgIHVybDogJy9zaWdudXAnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy91c2VyL3ZpZXdzL3NpZ251cC5jbGllbnQudmlldy5odG1sJ1xyXG4gICAgICB9KS5zdGF0ZSgnc2lnbmluJywge1xyXG4gICAgICAgIHVybDogJy9zaWduaW4nLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy91c2VyL3ZpZXdzL3NpZ25pbi5jbGllbnQudmlldy5odG1sJyxcclxuICAgICAgfSkuc3RhdGUoJ3NlY3VyZXZpZXcnLCB7XHJcbiAgICAgICAgdXJsOiAnL3NlY3VyZXZpZXcnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy91c2VyL3ZpZXdzL3NlY3VyZXZpZXcuY2xpZW50LnZpZXcuaHRtbCcsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgcmVxdWlyZXNMb2dpbjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfV0pXHJcbiAgLnJ1bihbJyRyb290U2NvcGUnLCAnJHdpbmRvdycsICdzdG9yZScsICdqd3RIZWxwZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkd2luZG93LCBzdG9yZSwgand0SGVscGVyKSB7XHJcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbihlLCB0bykge1xyXG4gICAgICBpZiAodG8uZGF0YSAmJiB0by5kYXRhLnJlcXVpcmVzTG9naW4pIHtcclxuICAgICAgICBpZiAoIXN0b3JlLmdldCgnand0JykpIHtcclxuICAgICAgICAgICR3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvc2lnbmluJztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgndXNlcicpXHJcbiAgLmNvbnRyb2xsZXIoJ1VzZXJDb250cm9sbGVyJywgWyckd2luZG93JywgJ1VzZXJzJywgJyRodHRwJywgJ3N0b3JlJywgJ2p3dEhlbHBlcicsICckc3RhdGVQYXJhbXMnLCBmdW5jdGlvbigkd2luZG93LCBVc2VycywgJGh0dHAsIHN0b3JlLCBqd3RIZWxwZXIsICRzdGF0ZVBhcmFtcykge1xyXG5cclxuICAgIHRoaXMudXNlciA9IHt9O1xyXG5cclxuICAgIHRoaXMuc2lnbnVwID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vICRodHRwKHtcclxuICAgICAgLy8gICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3VzZXJzL3NpZ251cCcsXHJcbiAgICAgIC8vICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIC8vICAgZGF0YTogdGhpcy51c2VyXHJcbiAgICAgIC8vIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgLy8gICBzdG9yZS5zZXQoJ2p3dCcsIHJlc3BvbnNlLmRhdGEudG9rZW4pO1xyXG4gICAgICAvLyAgICR3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvcGFuZWwnO1xyXG4gICAgICAvLyB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgLy8gICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAvLyAgIHRoaXMuZXJyTWVzc2FnZSA9IGVyci5kYXRhLm1lc3NhZ2U7XHJcbiAgICAgIC8vIH0pO1xyXG4gICAgICB2YXIgbmV3VXNlciA9IG5ldyBVc2Vycy5hcGkodGhpcy51c2VyKTtcclxuXHJcbiAgICAgIG5ld1VzZXIuJHNhdmUoZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgICAgc3RvcmUuc2V0KCdqd3QnLCByZXNwb25zZS50b2tlbik7XHJcbiAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9wYW5lbCc7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnNpZ25pbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAkaHR0cCh7XHJcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS91c2Vycy9zaWduaW4nLFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGRhdGE6IHRoaXMudXNlclxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVzcG9uc2UuZGF0YS50b2tlbjtcclxuICAgICAgICBzdG9yZS5zZXQoJ2p3dCcsIHRva2VuKTtcclxuICAgICAgICAkd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL3BhbmVsJztcclxuICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgdGhpcy5lcnJNZXNzYWdlID0gZXJyLmRhdGEubWVzc2FnZTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0QWxsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIFVzZXJzLmFwaS5xdWVyeShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMudXNlcnMgPSByZXNwb25zZS5maWx0ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgcmV0dXJuIGUucm9sZSA9PT0gJ1RlY2gnO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5nZXRPbmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgVXNlcnMuYXBpLmdldCh7XHJcbiAgICAgICAgaWQ6ICRzdGF0ZVBhcmFtcy5pZFxyXG4gICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMudXNlciA9IHJlc3BvbnNlO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pc0F1dGggPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHRva2VuID0gc3RvcmUuZ2V0KCdqd3QnKTtcclxuICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gand0SGVscGVyLmRlY29kZVRva2VuKHRva2VuKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHRva2VuID0gc3RvcmUuZ2V0KCdqd3QnKTtcclxuICAgICAgdmFyIGRlY29kZWQgPSBqd3RIZWxwZXIuZGVjb2RlVG9rZW4odG9rZW4pO1xyXG4gICAgICBVc2Vycy5sb2dvdXQuZ2V0KHtcclxuICAgICAgICBpZDogZGVjb2RlZC5faWRcclxuICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc3RvcmUucmVtb3ZlKCdqd3QnKTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH1dKTtcclxuXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgndXNlcicpXHJcbiAgLmRpcmVjdGl2ZShcImNvbXBhcmVUb1wiLCBbZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXF1aXJlOiBcIm5nTW9kZWxcIixcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBvdGhlck1vZGVsVmFsdWU6IFwiPWNvbXBhcmVUb1wiXHJcbiAgICAgIH0sXHJcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyaWJ1dGVzLCBuZ01vZGVsKSB7XHJcblxyXG4gICAgICAgIG5nTW9kZWwuJHZhbGlkYXRvcnMuY29tcGFyZVRvID0gZnVuY3Rpb24obW9kZWxWYWx1ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIG1vZGVsVmFsdWUgPT0gc2NvcGUub3RoZXJNb2RlbFZhbHVlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHNjb3BlLiR3YXRjaChcIm90aGVyTW9kZWxWYWx1ZVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIG5nTW9kZWwuJHZhbGlkYXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfV0pO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3VzZXInKVxyXG4gIC5kaXJlY3RpdmUoJ3JlY29yZEF2YWlsYWJpbGl0eVZhbGlkYXRvcicsIFsnJGh0dHAnLCAnVXNlcnMnLCBmdW5jdGlvbigkaHR0cCwgVXNlcnMpIHtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xyXG4gICAgICAgIC8vdmFyIGFwaVVybCA9IGF0dHJzLnJlY29yZEF2YWlsYWJpbGl0eVZhbGlkYXRvcjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0QXNMb2FkaW5nKGJvb2wpIHtcclxuICAgICAgICAgIG5nTW9kZWwuJHNldFZhbGlkaXR5KCdyZWNvcmRMb2FkaW5nJywgIWJvb2wpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0QXNBdmFpbGFibGUoYm9vbCkge1xyXG4gICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3JlY29yZEF2YWlsYWJsZScsIGJvb2wpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbmdNb2RlbC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgIHNldEFzTG9hZGluZyh0cnVlKTtcclxuICAgICAgICAgIHNldEFzQXZhaWxhYmxlKGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAvLyB1c2luZyByZXNvdXJjZVxyXG4gICAgICAgICAgdmFyIGRhdGEgPSBVc2Vycy5zZWFyY2guZ2V0KHtcclxuICAgICAgICAgICAgbmFtZTogdmFsdWVcclxuICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5kYXRhID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgc2V0QXNMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICBzZXRBc0F2YWlsYWJsZSh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfV0pOyIsIi8vQXJ0aWNsZXMgc2VydmljZSB1c2VkIGZvciBjb21tdW5pY2F0aW5nIHdpdGggdGhlIGFydGljbGVzIFJFU1QgZW5kcG9pbnRzXHJcbmFuZ3VsYXIubW9kdWxlKCd1c2VyJykuZmFjdG9yeSgnVXNlcnMnLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uKCRyZXNvdXJjZSkge1xyXG5cclxuICAgIHZhciBhcGkgPSAkcmVzb3VyY2UoJ2FwaS91c2Vycy9zaWdudXAvOmlkJywge1xyXG4gICAgICAgIGlkOiAnQF9pZCdcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBsb2dvdXQgPSAkcmVzb3VyY2UoJ2FwaS91c2Vycy9sb2dvdXQvOmlkJywge1xyXG4gICAgICAgIGlkOiAnQF9pZCdcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBzZWFyY2ggPSAkcmVzb3VyY2UoJ2FwaS91c2Vycy9zZWFyY2gvOm5hbWUnLCB7XHJcbiAgICAgICAgbmFtZTogJ0BuYW1lJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBhcGk6IGFwaSxcclxuICAgICAgICBsb2dvdXQ6IGxvZ291dCxcclxuICAgICAgICBzZWFyY2g6IHNlYXJjaFxyXG4gICAgfTtcclxufVxyXG5dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
